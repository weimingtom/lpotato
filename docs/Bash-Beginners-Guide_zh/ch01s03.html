<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <title>1.3.&nbsp;执行命令</title>
      <link rel="stylesheet" href="docbook.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
      <meta name="keywords" content="Linux, Scripts, linux, Bash, guide, Guide, Exercises, exercises, bash, scripting, Scripting, awk, sed, variables, functions, loops, conditionals">
      <link rel="start" href="index.html" title="Bash新手指南">
      <link rel="up" href="ch01.html" title="第&nbsp;1&nbsp;章&nbsp;Bash和Bash脚本">
      <link rel="prev" href="ch01s02.html" title="1.2.&nbsp;Bourne Again SHell的优势">
      <link rel="next" href="ch01s04.html" title="1.4.&nbsp;建立块">
   </head>
   <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center">1.3.&nbsp;执行命令</th>
            </tr>
            <tr>
               <td width="20%" align="left"><a accesskey="p" href="ch01s02.html">上一页</a>&nbsp;
               </td>
               <th width="60%" align="center">第&nbsp;1&nbsp;章&nbsp;Bash和Bash脚本</th>
               <td width="20%" align="right">&nbsp;<a accesskey="n" href="ch01s04.html">下一页</a></td>
            </tr>
         </table>
         <hr>
      </div>
      <div class="sect1" lang="zh-cn">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both"><a name="sect_01_03"></a>1.3.&nbsp;执行命令
                  </h2>
               </div>
            </div>
         </div>
         <div class="sect2" lang="zh-cn">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a name="sect_01_03_01"></a>1.3.1.&nbsp;概要
                     </h3>
                  </div>
               </div>
            </div>
            <p>Bash会确定执行的程序的类型。普通程序是那些已经为你的系统编译好的系统命令。当这样的程序 
               运行的时候，Bash创建一个自身的拷贝因此一个新的进程就被创建。子进程和父进程拥有一样的环境，唯一个区别只有进程号。这个过程被称作内核空间创建进程 <span class="emphasis"><em>forking</em></span>。
            </p>
            <p>在内核空间创建进程后，子进程的地址空间被新进程数据覆盖。此步骤通过 <span class="emphasis"><em>exec</em></span> 系统调用完成。
            </p>
            <p> <span class="emphasis"><em>fork-and-exec</em></span> 机制因此把旧的命令转化成新的，虽然新程序的执行环境还是和原来相同，包括输入输出设备的配置，环境变量和优先级。这种机制用来创建所有的UNIX进程，因此对Linux操作系统也起作用，甚至是第一个进程,进程号是1的 <span><strong class="command">init</strong></span>，也是在称为 <span class="emphasis"><em>bootstrapping</em></span> 的启动过程中被fork的。
            </p>
         </div>
         <div class="sect2" lang="zh-cn">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a name="sect_01_03_02"></a>1.3.2.&nbsp;Shell内建命令
                     </h3>
                  </div>
               </div>
            </div>
            <p>内建的命令包含在shell本身里面。当内建的命令的名字被用作一个简单命令的第一个词时，shell 直接执行那个命令，而不创建新的进程。内建命令在实现那些单独的程序不可能或者不便实现的某些功能时时很有必要的</p>
            <p>bash支持3种内建的命令：</p>
            <div class="itemizedlist">
               <ul type="disc">
                  <li>
                     <p>Bourne Shell内建命令：</p>
                     <p><span><strong class="command">:</strong></span>, <span><strong class="command">.</strong></span>, <span><strong class="command">break</strong></span>, <span><strong class="command">cd</strong></span>, <span><strong class="command">continue</strong></span>, <span><strong class="command">eval</strong></span>, <span><strong class="command">exec</strong></span>, <span><strong class="command">exit</strong></span>, <span><strong class="command">export</strong></span>, <span><strong class="command">getopts</strong></span>, <span><strong class="command">hash</strong></span>, <span><strong class="command">pwd</strong></span>, <span><strong class="command">readonly</strong></span>, <span><strong class="command">return</strong></span>, <span><strong class="command">set</strong></span>, <span><strong class="command">shift</strong></span>, <span><strong class="command">test</strong></span>, <span><strong class="command">[</strong></span>, <span><strong class="command">times</strong></span>, <span><strong class="command">trap</strong></span>, <span><strong class="command">umask</strong></span> and <span><strong class="command">unset</strong></span>.
                     </p>
                  </li>
                  <li>
                     <p>Bash内建命令：</p>
                     <p><span><strong class="command">alias</strong></span>, <span><strong class="command">bind</strong></span>, <span><strong class="command">builtin</strong></span>, <span><strong class="command">command</strong></span>, <span><strong class="command">declare</strong></span>, <span><strong class="command">echo</strong></span>, <span><strong class="command">enable</strong></span>, <span><strong class="command">help</strong></span>, <span><strong class="command">let</strong></span>, <span><strong class="command">local</strong></span>, <span><strong class="command">logout</strong></span>, <span><strong class="command">printf</strong></span>, <span><strong class="command">read</strong></span>, <span><strong class="command">shopt</strong></span>, <span><strong class="command">type</strong></span>, <span><strong class="command">typeset</strong></span>, <span><strong class="command">ulimit</strong></span> and <span><strong class="command">unalias</strong></span>.
                     </p>
                  </li>
                  <li>
                     <p>特殊内建命令：</p>
                     <p>当Bash在POSIX模式运行，特殊内建命令和其他内建命令有3个方面的区别：</p>
                     <div class="orderedlist">
                        <ol type="1">
                           <li>
                              <p>特殊内建命令在shell函数在命令查找期间先被找到。</p>
                           </li>
                           <li>
                              <p>如果一个特殊内建命令返回一个错误状态，一个非交互shell就会退出。</p>
                           </li>
                           <li>
                              <p>在命令完成后在该命令之前的赋值语句仍然在shell环境中起作用。</p>
                           </li>
                        </ol>
                     </div>
                     <p>POSIX特殊内建命令是：<span><strong class="command">:</strong></span>, <span><strong class="command">.</strong></span>, <span><strong class="command">break</strong></span>, <span><strong class="command">continue</strong></span>, <span><strong class="command">eval</strong></span>, <span><strong class="command">exec</strong></span>, <span><strong class="command">exit</strong></span>, <span><strong class="command">export</strong></span>, <span><strong class="command">readonly</strong></span>, <span><strong class="command">return</strong></span>, <span><strong class="command">set</strong></span>, <span><strong class="command">shift</strong></span>, <span><strong class="command">trap</strong></span> and <span><strong class="command">unset</strong></span>.
                     </p>
                  </li>
               </ul>
            </div>
            <p>多数这些内建命令将在下面的章节讨论。关于那些不是这些情况的命令，我们在INFO页面查阅。</p>
         </div>
         <div class="sect2" lang="zh-cn">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a name="sect_01_03_03"></a>1.3.3.&nbsp;从脚本执行程序
                     </h3>
                  </div>
               </div>
            </div>
            <p>当程序被一个脚本来执行，bash会使用 <span class="emphasis"><em>fork</em></span> 创建一个新的bash进程。这个子shell一次从shell脚本中读取一行。每行的命令如果直接来自键盘的话会被读取，解释和执行
            </p>
            <p>当子shell处理脚本中的每一行时，父进程等待子进程结束。当运行完shell脚本中每一行时，子shell就结束。父shell苏醒并且显示一个新的提示符。</p>
         </div>
      </div>
      <div class="navfooter">
         <hr>
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left"><a accesskey="p" href="ch01s02.html">上一页</a>&nbsp;
               </td>
               <td width="20%" align="center"><a accesskey="u" href="ch01.html">上一级</a></td>
               <td width="40%" align="right">&nbsp;<a accesskey="n" href="ch01s04.html">下一页</a></td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top">1.2.&nbsp;Bourne Again SHell的优势&nbsp;</td>
               <td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
               <td width="40%" align="right" valign="top">&nbsp;1.4.&nbsp;建立块</td>
            </tr>
         </table>
      </div>
   </body>
</html>