<html>
   <head>
      <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
   
      <title>9.6.&nbsp;使用select内建命令来制作菜单</title>
      <link rel="stylesheet" href="docbook.css" type="text/css">
      <meta name="generator" content="DocBook XSL Stylesheets V1.69.1">
      <meta name="keywords" content="Linux, Scripts, linux, Bash, guide, Guide, Exercises, exercises, bash, scripting, Scripting, awk, sed, variables, functions, loops, conditionals">
      <link rel="start" href="index.html" title="Bash新手指南">
      <link rel="up" href="ch09.html" title="第&nbsp;9&nbsp;章&nbsp;重复性任务">
      <link rel="prev" href="ch09s05.html" title="9.5.&nbsp;Break 和 continue">
      <link rel="next" href="ch09s07.html" title="9.7.&nbsp;shift内建命令">
   </head>
   <body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF">
      <div class="navheader">
         <table width="100%" summary="Navigation header">
            <tr>
               <th colspan="3" align="center">9.6.&nbsp;使用select内建命令来制作菜单</th>
            </tr>
            <tr>
               <td width="20%" align="left"><a accesskey="p" href="ch09s05.html">上一页</a>&nbsp;
               </td>
               <th width="60%" align="center">第&nbsp;9&nbsp;章&nbsp;重复性任务</th>
               <td width="20%" align="right">&nbsp;<a accesskey="n" href="ch09s07.html">下一页</a></td>
            </tr>
         </table>
         <hr>
      </div>
      <div class="sect1" lang="zh-cn">
         <div class="titlepage">
            <div>
               <div>
                  <h2 class="title" style="clear: both"><a name="sect_09_06"></a>9.6.&nbsp;使用select内建命令来制作菜单
                  </h2>
               </div>
            </div>
         </div>
         <div class="sect2" lang="zh-cn">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a name="sect_09_06_01"></a>9.6.1.&nbsp;概要
                     </h3>
                  </div>
               </div>
            </div>
            <div class="sect3" lang="zh-cn">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title"><a name="sect_09_06_01_01"></a>9.6.1.1.&nbsp;select的使用
                        </h4>
                     </div>
                  </div>
               </div>
               <p> <span><strong class="command">select</strong></span> 结构可以生成简单的菜单。语法和 <span><strong class="command">for</strong></span> 循环非常相似：
               </p>
               <div class="cmdsynopsis">
                  <p><code class="command">select <code class="varname">WORD</code> [in <code class="varname">LIST</code>]; do RESPECTIVE-COMMANDS; done</code> 
                  </p>
               </div>
               <p><code class="varname">LIST</code> 扩展开来，生成一个项目的列表。扩展后的内容被打印到标准错误；每个项目都以一个数字开始。如果 <span><strong class="command">in <code class="varname">LIST</code></strong></span> 不存在，位置参数就打印出来，the positional parameters are printed, as if <span><strong class="command">in <code class="varname">$@</code></strong></span> would have been specified.  <code class="varname">LIST</code> 只打印一次。
               </p>
               <p>在打印所有项目的时候，<code class="varname">PS3</code> 提示被打印出来然后读取来自标准输入的一行。如果这行由那个项目的相关数字组成，那么 <code class="varname">WORD</code> 的值就设置成那个项目的名字。如果这行是空的，项目和 <code class="varname">PS3</code> 提示就再次显示出来。如果一个 <span class="emphasis"><em>EOF</em></span> (End Of File) 字符被读取，循环就退出。既然多数用户ince most users don't have a clue which key combination is used for the EOF sequence, it
                  is more user-friendly to have a <span><strong class="command">break</strong></span> command as one of the items.  Any other value of the read line will set <code class="varname">WORD</code> to be a null string.
               </p>
               <p>读取的行存储在 <code class="varname">REPLY</code> 变量。
               </p>
               <p> <span><strong class="command">RESPECTIVE-COMMANDS</strong></span> 在每个选择之后执行直到读取了代表 <span><strong class="command">break</strong></span> 的数字。退出循环。
               </p>
            </div>
            <div class="sect3" lang="zh-cn">
               <div class="titlepage">
                  <div>
                     <div>
                        <h4 class="title"><a name="sect_09_06_01_02"></a>9.6.1.2.&nbsp;例子
                        </h4>
                     </div>
                  </div>
               </div>
               <p>这是一个非常简单的例子，但是正像你看到的，并不是特别的友好：</p><pre class="screen">
<code class="prompt">[carol@octarine testdir]</code> <span><strong class="command">cat <code class="filename">private.sh</code></strong></span>
#!/bin/bash

echo "This script can make any of the files in this directory private."
echo "Enter the number of the file you want to protect:"

select FILENAME in *;
do
     echo "You picked $FILENAME ($REPLY), it is now only accessible to you."
     chmod go-rwx "$FILENAME"
done

<code class="prompt">[carol@octarine testdir]</code> <span><strong class="command">./private.sh</strong></span>
This script can make any of the files in this directory private.
Enter the number of the file you want to protect:
1) archive-20030129
2) bash
3) private.sh
#? 1
You picked archive-20030129 (1)
#?
</pre><p>设置 <code class="varname">PS3</code> 提示且加入一个退出的可能性来做的更好：
               </p><pre class="screen">
#!/bin/bash

echo "This script can make any of the files in this directory private."
echo "Enter the number of the file you want to protect:"

PS3="Your choice: "
QUIT="QUIT THIS PROGRAM - I feel safe now."
touch "$QUIT"

select FILENAME in *;
do
  case $FILENAME in
        "$QUIT")
          echo "Exiting."
          break
          ;;
        *)
          echo "You picked $FILENAME ($REPLY)"
          chmod go-rwx "$FILENAME"
          ;;
  esac
done
rm "$QUIT"
</pre></div>
         </div>
         <div class="sect2" lang="zh-cn">
            <div class="titlepage">
               <div>
                  <div>
                     <h3 class="title"><a name="sect_09_06_02"></a>9.6.2.&nbsp;子菜单
                     </h3>
                  </div>
               </div>
            </div>
            <p>任何 <span><strong class="command">select</strong></span> 结构中的语句可以是另外一个 <span><strong class="command">select</strong></span> 循环，通过菜单来启用子菜单。
            </p>
            <p>默认，<code class="varname">PS3</code> 变量在进入嵌套 <span><strong class="command">select</strong></span> 循环的时候没有改变。如果你想得到一个不同的提示，确定在适当的时机进行设置。
            </p>
         </div>
      </div>
      <div class="navfooter">
         <hr>
         <table width="100%" summary="Navigation footer">
            <tr>
               <td width="40%" align="left"><a accesskey="p" href="ch09s05.html">上一页</a>&nbsp;
               </td>
               <td width="20%" align="center"><a accesskey="u" href="ch09.html">上一级</a></td>
               <td width="40%" align="right">&nbsp;<a accesskey="n" href="ch09s07.html">下一页</a></td>
            </tr>
            <tr>
               <td width="40%" align="left" valign="top">9.5.&nbsp;Break 和 continue&nbsp;</td>
               <td width="20%" align="center"><a accesskey="h" href="index.html">起始页</a></td>
               <td width="40%" align="right" valign="top">&nbsp;9.7.&nbsp;shift内建命令</td>
            </tr>
         </table>
      </div>
   </body>
</html>