<html><head>
      <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Chapter&nbsp;19.&nbsp;JMS (Java Message Service)</title><link rel="stylesheet" href="html.css" type="text/css"><meta name="generator" content="DocBook XSL Stylesheets V1.60.1"><link rel="home" href="index.html" title="Spring Framework &#24320;&#21457;&#21442;&#32771;&#25163;&#20876;"><link rel="up" href="spring-integration.html" title="Part&nbsp;IV.&nbsp;&#25972;&#21512;"><link rel="previous" href="ejb.html" title="Chapter&nbsp;18.&nbsp;Enterprise Java Beans (EJB) &#38598;&#25104;"><link rel="next" href="jmx.html" title="Chapter&nbsp;20.&nbsp;JMX"></head><body bgcolor="white" text="black" link="#0000FF" vlink="#840084" alink="#0000FF"><div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="background-color:white;border:none;height:73px;border:1px solid black;"><a style="border:none;" href="http://www.springframework.org/" title="The Spring Framework"><img style="border:none;" src="images/xdev-spring_logo.jpg"></a><a style="border:none;" href="http://www.springsource.com/" title="SpringSource"><img style="border:none;position:absolute;padding-top:5px;right:42px;" src="images/springsource-banner-rhs.png"></a></div><div class="chapter" lang="en"><div class="titlepage"><div><div><h2 class="title"><a name="jms"></a>Chapter&nbsp;19.&nbsp;JMS (Java Message Service)</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-introduction"></a>19.1.&nbsp;&#31616;&#20171;</h2></div></div><div></div></div><p>Spring&#25552;&#20379;&#20102;&#19968;&#20010;&#29992;&#20110;&#31616;&#21270;JMS API&#20351;&#29992;&#30340;&#25277;&#35937;&#26694;&#26550;&#65292;&#24182;&#19988;&#23545;&#29992;&#25143;&#23631;&#34109;&#20102;JMS API&#20013;1.0.2&#21644;1.1&#29256;&#26412;&#30340;&#24046;&#24322;&#12290;</p><p>JMS&#30340;&#21151;&#33021;&#22823;&#33268;&#19978;&#20998;&#20026;&#20004;&#22359;&#65292;&#21483;&#20570;&#28040;&#24687;&#21046;&#36896;&#21644;&#28040;&#24687;&#28040;&#32791;&#12290;<tt class="classname">JmsTemplate</tt> &#29992;&#20110;&#21046;&#36896;&#28040;&#24687;&#21644;&#21516;&#27493;&#28040;&#24687;&#25509;&#25910;&#12290;&#21644;Java EE&#30340;&#20107;&#20214;&#39537;&#21160;Bean&#39118;&#26684;&#31867;&#20284;&#65292;&#23545;&#20110;&#24322;&#27493;&#25509;&#25910;&#28040;&#24687;&#65292;Spring&#25552;&#20379;&#20102;&#19968;&#20123;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;&#26469;&#21019;&#24314;&#28040;&#24687;&#39537;&#21160;&#30340;POJO&#65288;MDP&#65289;&#12290; 
	</p><div class="sidebar"><p class="title"><b>&#28040;&#24687;&#22495;&#30340;&#32479;&#19968;</b></p><p>JMS&#35268;&#33539;&#26377;&#20004;&#20010;&#20027;&#35201;&#30340;&#29256;&#26412;&#65292;1.0.2&#21644;1.1&#12290;</p><p>JMS1.0.2&#23450;&#20041;&#20102;&#20004;&#31181;&#28040;&#24687;&#22495;&#65292;&#28857;&#23545;&#28857;&#65288;&#38431;&#21015;&#65289;&#21644;&#21457;&#24067;/&#35746;&#38405;&#65288;&#20027;&#39064;&#65289;&#12290;JMS 1.0.2&#30340;API&#20026;&#27599;&#20010;&#28040;&#24687;&#22495;&#25552;&#20379;&#20102;&#19968;&#20010;&#24179;&#34892;&#30340;&#31867;&#23618;&#27425;&#32467;&#26500;&#12290;&#23548;&#33268;&#23458;&#25143;&#31471;&#24212;&#29992;&#21482;&#33021;&#20351;&#29992;&#29305;&#23450;&#28040;&#24687;&#22495;&#30340;JMS API&#12290;JMS 1.1&#24341;&#36827;&#20102;&#32479;&#19968;&#28040;&#24687;&#22495;&#30340;&#27010;&#24565;&#20351;&#36825;&#20004;&#31181;&#28040;&#24687;&#22495;&#20043;&#38388;&#21151;&#33021;&#21644;&#23458;&#25143;&#31471;API&#30340;&#24046;&#21035;&#23613;&#21487;&#33021;&#23567;&#12290;&#20030;&#20010;&#24050;&#28040;&#38500;&#30340;&#21151;&#33021;&#24046;&#24322;&#30340;&#20363;&#23376;&#65292;&#22914;&#26524;&#20320;&#20351;&#29992;&#30340;&#26159;JMS 1.1&#30340;&#28040;&#24687;&#20379;&#24212;&#32773;&#65292;&#20320;&#21487;&#20197;&#20351;&#29992;&#21516;&#19968;&#20010; <tt class="literal">Session</tt> &#20107;&#21153;&#24615;&#22320;&#22312;&#19968;&#20010;&#22495;&#28040;&#32791;&#20102;&#19968;&#20010;&#28040;&#24687;&#21518;&#24182;&#19988;&#22312;&#21478;&#19968;&#20010;&#22495;&#20013;&#20135;&#29983;&#19968;&#20010;&#28040;&#24687;&#12290; 
        </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>JMS 1.1&#30340;&#35268;&#33539;&#21457;&#24067;&#20110;2002&#24180;4&#26376;&#65292;&#24182;&#19988;&#22312;2003&#24180;11&#26376;&#25104;&#20026;J2EE 1.4&#30340;&#19968;&#20010;&#32452;&#25104;&#37096;&#20998;&#65292;&#32467;&#26524;&#65292;&#29616;&#22312;&#22522;&#20110;J2EE1.3&#30340;&#24212;&#29992;&#26381;&#21153;&#22120;&#36824;&#22312;&#22823;&#37327;&#20351;&#29992;&#65288;&#20363;&#22914;BEA WebLogic 8.1&#21644;IBM WebSphere 5.1)&#65289;&#65292;&#23427;&#20204;&#21482;&#25903;&#25345;JMS 1.0.2&#30340;&#35268;&#33539;&#12290;
        </p></td></tr></table></div></div><p><tt class="literal">org.springframework.jms.core</tt> &#21253;&#25552;&#20379;&#20351;&#29992;JMS&#30340;&#26680;&#24515;&#21151;&#33021;&#12290;
    &#23601;&#35937;&#20026;JDBC&#25552;&#20379;&#30340; <tt class="literal">JdbcTemplate</tt>  &#19968;&#26679;&#65292;&#23427;&#25552;&#20379;&#20102;JMS&#27169;&#26495;&#31867;&#26469;&#22788;&#29702;&#36164;&#28304;&#30340;&#21019;&#24314;&#21644;&#37322;&#25918;&#20197;&#31616;&#21270;JMS&#30340;&#20351;&#29992;&#12290;Spring&#27169;&#26495;&#31867;&#30340;&#20844;&#20849;&#35774;&#35745;&#21407;&#21017;&#23601;&#26159;&#36890;&#36807;&#25552;&#20379;&#21161;&#25163;&#26041;&#27861;&#21435;&#25191;&#34892;&#20844;&#20849;&#30340;&#25805;&#20316;&#65292;&#24182;&#23558;&#23454;&#38469;&#30340;&#22788;&#29702;&#20219;&#21153;&#22996;&#27966;&#21040;&#29992;&#25143;&#23454;&#29616;&#30340;&#22238;&#35843;&#25509;&#21475;&#19978;&#65292;&#20174;&#32780;&#23436;&#25104;&#26356;&#22797;&#26434;&#30340;&#25805;&#20316;&#12290;JMS&#27169;&#26495;&#20063;&#36981;&#24490;&#36825;&#26679;&#30340;&#35774;&#35745;&#21407;&#21017;&#12290;&#36825;&#20123;&#31867;&#25552;&#20379;&#20247;&#22810;&#20415;&#21033;&#30340;&#26041;&#27861;&#26469;&#21457;&#36865;&#28040;&#24687;&#12289;&#21516;&#27493;&#25509;&#25910;&#28040;&#24687;&#12289;&#20351;&#29992;&#25143;&#21487;&#20197;&#25509;&#35302;&#21040;JMS session&#21644;&#28040;&#24687;&#20135;&#29983;&#32773;&#12290;
    </p><p><tt class="literal">org.springframework.jms.support</tt> &#21253;&#25552;&#20379;JMSException&#30340;&#36716;&#25442;&#21151;&#33021;&#12290;&#23427;&#23558;&#21463;&#25511;&#30340; JMSException&#24322;&#24120;&#23618;&#27425;&#36716;&#25442;&#21040;&#19968;&#20010;&#23545;&#24212;&#30340;&#38750;&#21463;&#25511;&#24322;&#24120;&#23618;&#27425;&#12290;&#20219;&#20309;&#21463;&#25511;javax.jms.JMSException&#24322;&#24120;&#30340;&#23376;&#31867;&#37117;&#34987;&#21253;&#35013;&#22312;&#38750;&#21463;&#25511;UncategorizedJmsException&#24322;&#24120;&#37324;&#12290; 
    </p><p><tt class="literal">org.springframework.jms.support.converter</tt> &#21253;&#25552;&#20379;&#19968;&#20010; <tt class="interfacename">MessageConverter</tt> &#29992;&#26469;&#25277;&#35937;Java&#23545;&#35937;&#21644;JMS&#28040;&#24687;&#20043;&#38388;&#30340;&#36716;&#25442;&#25805;&#20316;&#12290;
    </p><p>
         <tt class="literal">org.springframework.jms.support.destination</tt> &#21253;&#20026;&#31649;&#29702;JMS&#30446;&#30340;&#22320;&#25552;&#20379;&#22810;&#31181;&#31574;&#30053;&#65292;&#20363;&#22914;&#20026;&#23384;&#20648;&#22312;JNDI&#20013;&#30340;&#30446;&#30340;&#22320;&#25552;&#20379;&#19968;&#20010;&#26381;&#21153;&#23450;&#20301;&#22120;&#12290; 
    </p><p>&#26368;&#21518;&#65292;<tt class="literal">org.springframework.jms.connection</tt> &#21253;&#25552;&#20379;&#19968;&#20010;&#36866;&#21512;&#22312;&#29420;&#31435;&#24212;&#29992;&#20013;&#20351;&#29992;&#30340;
<tt class="classname">ConnectionFactory</tt> &#30340;&#23454;&#29616;&#12290;&#23427;&#36824;&#20026;JMS&#25552;&#20379;&#20102;&#19968;&#20010;Spring&#30340; <tt class="literal">PlatformTransactionManager</tt> &#30340;&#23454;&#29616;&#65288;&#29616;&#22312;&#21483;&#20570; <tt class="classname">JmsTransactionManager</tt>&#65289;&#12290;
&#36825;&#26679;&#21487;&#20197;&#25226;JMS&#20316;&#20026;&#19968;&#20010;&#20107;&#21153;&#36164;&#28304;&#26080;&#32541;&#22320;&#38598;&#25104;&#21040;Spring&#30340;&#20107;&#21153;&#31649;&#29702;&#26426;&#21046;&#20013;&#21435;&#12290; 
  </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-using"></a>19.2.&nbsp;&#20351;&#29992;Spring JMS</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="d0e31311"></a>19.2.1.&nbsp;<tt class="classname">JmsTemplate</tt></h3></div></div><div></div></div><p><tt class="classname">JmsTemplate</tt> &#31867;&#26377;&#20004;&#20010;&#23454;&#29616;&#26041;&#24335;&#12290;<tt class="classname">JmsTemplate</tt> &#31867;&#20351;&#29992;JMS 1.1&#30340;API&#65292;
&#32780;&#23376;&#31867; <tt class="classname">JmsTemplate102</tt> &#20351;&#29992;&#20102;JMS 1.0.2&#30340;API&#12290; 
        </p><p>&#20351;&#29992; <tt class="classname">JmsTemplate</tt> &#30340;&#20195;&#30721;&#21482;&#38656;&#35201;&#23454;&#29616;&#35268;&#33539;&#20013;&#23450;&#20041;&#30340;&#22238;&#35843;&#25509;&#21475;&#12290;
<tt class="classname">MessageCreator</tt> &#22238;&#35843;&#25509;&#21475;&#36890;&#36807;JmsTemplate&#20013;&#35843;&#29992;&#20195;&#30721;&#25552;&#20379;&#30340;Session&#26469;&#21019;&#24314;&#19968;&#26465;&#28040;&#24687;&#12290;
&#28982;&#32780;&#65292;&#20026;&#20102;&#20801;&#35768;&#26356;&#22797;&#26434;&#30340;JMS API&#24212;&#29992;&#65292;&#22238;&#35843;&#25509;&#21475; <tt class="classname">SessionCallback</tt> &#20026;&#29992;&#25143;&#25552;&#20379;JMS session&#65292;&#24182;&#19988;&#22238;&#35843;&#25509;&#21475; <tt class="classname">ProducerCallback</tt> &#23558;Session&#21644;MessageProducer&#23545;&#26174;&#38706;&#32473;&#29992;&#25143;&#12290; 
         </p><p>JMS API&#26377;&#20004;&#31181;&#21457;&#36865;&#26041;&#27861;&#65292;&#19968;&#31181;&#37319;&#29992;&#21457;&#36865;&#27169;&#24335;&#12289;&#20248;&#20808;&#32423;&#21644;&#23384;&#27963;&#26102;&#38388;&#20316;&#20026;&#26381;&#21153;&#36136;&#37327;&#65288;QOS&#65289;&#21442;&#25968;&#65292;&#21478;&#19968;&#31181;&#20351;&#29992;&#26080;&#38656;QOS&#21442;&#25968;&#30340;&#32570;&#30465;&#20540;&#26041;&#27861;&#12290;&#30001;&#20110;&#22312; <tt class="classname">JmsTemplate</tt> &#20013;&#26377;&#35768;&#22810;&#31181;&#21457;&#36865;&#26041;&#27861;&#65292;QOS&#21442;&#25968;&#36890;&#36807;bean&#30340;&#23646;&#24615;&#26041;&#24335;&#36827;&#34892;&#35774;&#32622;&#65292;&#20174;&#32780;&#36991;&#20813;&#22312;&#22810;&#31181;&#21457;&#36865;&#26041;&#27861;&#20013;&#37325;&#22797;&#12290;&#21516;&#26679;&#65292;&#20351;&#29992; <tt class="classname">setReceiveTimeout</tt> &#23646;&#24615;&#20540;&#26469;&#35774;&#32622;&#21516;&#27493;&#25509;&#25910;&#35843;&#29992;&#30340;&#36229;&#26102;&#20540;&#12290; 
            </p><p>&#26576;&#20123;JMS&#20379;&#24212;&#32773;&#20801;&#35768;&#36890;&#36807;ConnectionFactory&#30340;&#37197;&#32622;&#26469;&#35774;&#32622;&#32570;&#30465;&#30340;QOS&#20540;&#12290;&#36825;&#26679;&#22312;&#35843;&#29992; <tt class="classname">MessageProducer</tt> &#30340;&#21457;&#36865;&#26041;&#27861; <tt class="methodname">send(Destination destination, Message message)</tt> &#26102;&#20250;&#20351;&#29992;&#37027;&#20123;&#19981;&#21516;&#30340;QOS&#32570;&#30465;&#20540;&#65292;&#32780;&#19981;&#26159;JMS&#35268;&#33539;&#20013;&#23450;&#20041;&#30340;&#20540;&#12290;&#25152;&#20197;&#65292;&#20026;&#20102;&#25552;&#20379;&#23545;QOS&#20540;&#30340;&#19968;&#33268;&#31649;&#29702;&#65292;<tt class="classname">JmsTemplate</tt>&#24517;&#39035;&#36890;&#36807;&#35774;&#32622;&#24067;&#23572;&#20540;&#23646;&#24615; <span class="property">isExplicitQosEnabled</span> &#20026;true&#65292;&#20351;&#23427;&#33021;&#22815;&#20351;&#29992;&#33258;&#24049;&#30340;QOS&#20540;&#12290;
            </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p><tt class="classname">JmsTemplate</tt> &#31867;&#30340;&#23454;&#20363; <span class="emphasis"><em>&#19968;&#32463;&#37197;&#32622;&#20415;&#26159;&#32447;&#31243;&#23433;&#20840;</em></span> &#30340;&#12290;
				&#36825;&#24456;&#37325;&#35201;&#65292;&#22240;&#20026;&#36825;&#24847;&#21619;&#30528;&#20320;&#21487;&#20197;&#37197;&#32622;&#19968;&#20010; <tt class="classname">JmsTemplate</tt> &#30340;&#21333;&#20363;&#65292;&#28982;&#21518;&#25226;&#36825;&#20010; <span class="emphasis"><em>&#20849;&#20139;&#30340;</em></span> &#24341;&#29992;&#23433;&#20840;&#30340;&#27880;&#20837;&#22810;&#20010;&#21327;&#20316;&#30340;&#23545;&#35937;&#20013;&#12290;
				&#35201;&#28165;&#26970;&#19968;&#28857;&#65292;<tt class="classname">JmsTemplate</tt> &#26159;&#26377;&#29366;&#24577;&#30340;&#65292;&#22240;&#20026;&#23427;&#32500;&#25252;&#20102; <tt class="interfacename">ConnectionFactory</tt> &#30340;&#24341;&#29992;&#65292;&#20294;&#36825;&#20010;&#29366;&#24577;&#26102;&#19981;&#26159;&#20250;&#35805;&#29366;&#24577;&#12290;
				</p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-connections"></a>19.2.2.&nbsp;&#36830;&#25509;&#24037;&#21378;</h3></div></div><div></div></div><p><tt class="classname">JmsTemplate</tt> &#38656;&#35201;&#19968;&#20010;&#23545; <tt class="classname">ConnectionFactory</tt> &#30340;&#24341;&#29992;&#12290;<tt class="classname">ConnectionFactory</tt> &#26159;JMS&#35268;&#33539;&#30340;&#19968;&#37096;&#20998;&#65292;&#24182;&#19988;&#26159;&#20351;&#29992;JMS&#30340;&#20837;&#21475;&#12290;&#23458;&#25143;&#31471;&#24212;&#29992;&#36890;&#24120;&#29992;&#23427;&#20316;&#24037;&#21378;&#37197;&#21512;JMS&#25552;&#20379;&#32773;&#21435;&#21019;&#24314;&#36830;&#25509;&#65292;&#24182;&#23553;&#35013;&#35768;&#22810;&#21644;&#20379;&#24212;&#21830;&#30456;&#20851;&#30340;&#37197;&#32622;&#21442;&#25968;&#65292;&#20363;&#22914;SSL&#30340;&#37197;&#32622;&#36873;&#39033;&#12290; 
      </p><p>&#24403;&#22312;EJB&#37324;&#20351;&#29992;JMS&#26102;&#65292;&#20379;&#24212;&#21830;&#20250;&#25552;&#20379;JMS&#25509;&#21475;&#30340;&#23454;&#29616;&#65292;&#36825;&#26679;&#20204;&#21487;&#20197;&#21442;&#19982;&#22768;&#26126;&#24335;&#20107;&#21153;&#31649;&#29702;&#24182;&#25552;&#20379;&#36830;&#25509;&#27744;&#21644;&#20250;&#35805;&#27744;&#12290;
	  &#20026;&#20102;&#20351;&#29992;&#36825;&#20010;JMS&#23454;&#29616;&#65292;Java EE&#23481;&#22120;&#36890;&#24120;&#35201;&#27714;&#20320;&#22312;EJB&#25110;servlet&#37096;&#32626;&#25551;&#36848;&#31526;&#20013;&#22768;&#26126;&#19968;&#20010;JMS&#36830;&#25509;&#24037;&#21378;&#20570;&#20026; <span class="property">resource-ref</span>&#12290;
	  &#20026;&#30830;&#20445;&#21487;&#20197;&#22312;EJB&#20869;&#20351;&#29992; <tt class="classname">JmsTemplate</tt> &#30340;&#36825;&#20123;&#29305;&#24615;&#65292;&#23458;&#25143;&#24212;&#29992;&#24212;&#24403;&#30830;&#20445;&#23427;&#24341;&#29992;&#20102;&#34987;&#31649;&#29702;&#30340;ConnectionFactory&#23454;&#29616;&#12290; 
      </p><p>Spring&#25552;&#20379;&#20102;&#19968;&#20010; <tt class="classname">ConnectionFactory</tt> &#25509;&#21475;&#30340;&#23454;&#29616;&#65292;<tt class="classname">SingleConnectionFactory</tt>&#65292;&#23427;&#23558;&#22312;&#25152;&#26377;&#30340; <tt class="methodname">createConnection</tt> &#35843;&#29992;&#20013;&#36820;&#22238;&#19968;&#20010;&#30456;&#21516;&#30340; <tt class="classname">Connection</tt>&#65292;&#24182;&#24573;&#30053;&#25152;&#26377;&#23545; <tt class="methodname">close</tt>&#30340;&#35843;&#29992;&#12290;&#36825;&#22312;&#27979;&#35797;&#21644;&#29420;&#31435;&#29615;&#22659;&#20013;&#30456;&#24403;&#26377;&#29992;&#65292;&#22240;&#20026;&#22810;&#20010; <tt class="classname">JmsTemplate</tt> &#35843;&#29992;&#21487;&#20197;&#20351;&#29992;&#21516;&#19968;&#20010;&#36830;&#25509;&#20197;&#36328;&#36234;&#22810;&#20010;&#20107;&#21153;&#12290;<tt class="classname">SingleConnectionFactory</tt> &#36890;&#24120;&#24341;&#29992;&#19968;&#20010;&#26469;&#33258;JNDI&#30340;&#26631;&#20934; <tt class="classname">ConnectionFactory</tt>&#12290; 
      </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-destinations"></a>19.2.3.&nbsp;&#30446;&#30340;&#22320;&#31649;&#29702;</h3></div></div><div></div></div><p>&#21644;&#36830;&#25509;&#24037;&#21378;&#19968;&#26679;&#65292;&#30446;&#30340;&#22320;&#26159;&#21487;&#20197;&#22312;JNDI&#20013;&#23384;&#20648;&#21644;&#33719;&#21462;&#30340;JMS&#31649;&#29702;&#30340;&#23545;&#35937;&#12290;&#37197;&#32622;&#19968;&#20010;Spring&#24212;&#29992;&#19978;&#19979;&#25991;&#26102;&#65292;&#21487;&#20197;&#20351;&#29992;JNDI&#24037;&#21378;&#31867; <tt class="classname">JndiObjectFactoryBean</tt> &#25226;&#23545;&#20320;&#23545;&#35937;&#30340;&#24341;&#29992;&#20381;&#36182;&#27880;&#20837;&#21040;JMS&#30446;&#30340;&#22320;&#20013;&#12290;&#28982;&#32780;&#65292;&#22914;&#26524;&#22312;&#24212;&#29992;&#20013;&#26377;&#22823;&#37327;&#30340;&#30446;&#30340;&#22320;&#65292;&#25110;&#32773;JMS&#20379;&#24212;&#21830;&#25552;&#20379;&#20102;&#29305;&#26377;&#30340;&#39640;&#32423;&#30446;&#30340;&#22320;&#31649;&#29702;&#29305;&#24615;&#65292;&#36825;&#20010;&#31574;&#30053;&#24120;&#24120;&#26174;&#24471;&#24456;&#40635;&#28902;&#12290;&#21019;&#24314;&#21160;&#24577;&#30446;&#30340;&#22320;&#25110;&#25903;&#25345;&#30446;&#30340;&#22320;&#30340;&#21629;&#21517;&#31354;&#38388;&#23618;&#27425;&#23601;&#26159;&#36825;&#31181;&#39640;&#32423;&#30446;&#30340;&#22320;&#31649;&#29702;&#30340;&#20363;&#23376;&#12290;<tt class="classname">JmsTemplate</tt> &#23558;&#30446;&#30340;&#22320;&#21517;&#31216;&#21040;JMS&#30446;&#30340;&#22320;&#23545;&#35937;&#30340;&#35299;&#26512;&#22996;&#27966;&#32473; <tt class="classname">DestinationResolver</tt> &#25509;&#21475;&#30340;&#19968;&#20010;&#23454;&#29616;&#12290;<tt class="classname">JndiDestinationResolver</tt> &#26159; <tt class="classname">JmsTemplate</tt> &#20351;&#29992;&#30340;&#40664;&#35748;&#23454;&#29616;&#65292;&#24182;&#19988;&#25552;&#20379;&#21160;&#24577;&#30446;&#30340;&#22320;&#35299;&#26512;&#12290;&#21516;&#26102; <tt class="classname">JndiDestinationResolver</tt> &#20316;&#20026;JNDI&#20013;&#30340;&#30446;&#30340;&#22320;&#26381;&#21153;&#23450;&#20301;&#22120;&#65292;&#36824;&#21487;&#36873;&#25321;&#22238;&#36864;&#21435;&#20351;&#29992; <tt class="classname">DynamicDestinationResolver</tt> &#20013;&#30340;&#34892;&#20026;&#12290; 
       </p><p>&#32463;&#24120;&#35265;&#21040;&#19968;&#20010;JMS&#24212;&#29992;&#20013;&#20351;&#29992;&#30340;&#30446;&#30340;&#22320;&#22312;&#36816;&#34892;&#26102;&#25165;&#30693;&#36947;&#65292;&#22240;&#27492;&#65292;&#24403;&#37096;&#32626;&#19968;&#20010;&#24212;&#29992;&#26102;&#65292;&#23427;&#19981;&#33021;&#29992;&#21487;&#31649;&#29702;&#30340;&#26041;&#24335;&#21019;&#24314;&#12290;&#36825;&#26159;&#32463;&#24120;&#21457;&#29983;&#30340;&#65292;&#22240;&#20026;&#22312;&#20114;&#30456;&#20316;&#29992;&#30340;&#31995;&#32479;&#32452;&#20214;&#38388;&#26377;&#20123;&#20849;&#20139;&#24212;&#29992;&#36923;&#36753;&#20250;&#22312;&#36816;&#34892;&#30340;&#26102;&#20505;&#25353;&#29031;&#20849;&#21516;&#30340;&#21629;&#21517;&#35268;&#33539;&#21019;&#24314;&#28040;&#24687;&#30446;&#30340;&#22320;&#12290;&#34429;&#28982;&#21160;&#24577;&#21019;&#24314;&#30446;&#30340;&#22320;&#19981;&#26159;JMS&#35268;&#33539;&#30340;&#19968;&#37096;&#20998;&#65292;&#20294;&#26159;&#22823;&#22810;&#25968;&#20379;&#24212;&#21830;&#24050;&#32463;&#25552;&#20379;&#20102;&#36825;&#20010;&#21151;&#33021;&#12290;
&#29992;&#25143;&#20026;&#21160;&#24577;&#21019;&#24314;&#30340;&#30446;&#30340;&#22320;&#23450;&#20041;&#21644;&#20020;&#26102;&#30446;&#30340;&#22320;&#19981;&#21516;&#30340;&#21517;&#23383;&#65292;&#24182;&#19988;&#36890;&#24120;&#19981;&#34987;&#27880;&#20876;&#21040;JNDI&#20013;&#12290;&#19981;&#21516;&#20379;&#24212;&#21830;&#21019;&#24314;&#21160;&#24577;&#28040;&#24687;&#30446;&#30340;&#22320;&#25152;&#20351;&#29992;&#30340;API&#24046;&#24322;&#24456;&#22823;&#65292;&#22240;&#20026;&#21644;&#30446;&#30340;&#22320;&#30456;&#20851;&#30340;&#23646;&#24615;&#26159;&#20379;&#24212;&#21830;&#29305;&#26377;&#30340;&#12290;&#28982;&#32780;&#65292;&#26377;&#26102;&#30001;&#20379;&#24212;&#21830;&#20250;&#20316;&#20986;&#19968;&#20010;&#31616;&#21333;&#30340;&#23454;&#29616;&#36873;&#25321;-&#24573;&#30053;JMS&#35268;&#33539;&#20013;&#30340;&#35686;&#21578;&#65292;&#20351;&#29992; <tt class="classname">TopicSession</tt> &#30340;&#26041;&#27861; <tt class="methodname">createTopic(String topicName)</tt> &#25110;&#32773; <tt class="classname">QueueSession</tt> &#30340;&#26041;&#27861; <tt class="methodname">createQueue(String queueName)</tt> &#26469;&#21019;&#24314;&#19968;&#20010;&#24102;&#40664;&#35748;&#20540;&#23646;&#24615;&#30340;&#26032;&#30446;&#30340;&#22320;&#12290;&#20381;&#36182;&#20110;&#20379;&#24212;&#21830;&#30340;&#23454;&#29616;&#65292;<tt class="classname">DynamicDestinationResolver</tt> &#20063;&#21487;&#33021;&#21019;&#24314;&#19968;&#20010;&#29289;&#29702;&#19978;&#30340;&#30446;&#30340;&#22320;&#65292;&#32780;&#19981;&#20877;&#20165;&#20165;&#26159;&#19968;&#20010;&#35299;&#26512;&#12290;
       </p><p>&#24067;&#23572;&#23646;&#24615; <span class="property">pubSubDomain</span> &#29992;&#26469;&#37197;&#32622; <tt class="classname">JmsTemplate</tt> &#20351;&#29992;&#20160;&#20040;&#26679;&#30340;JMS&#22495;&#12290;&#36825;&#20010;&#23646;&#24615;&#30340;&#40664;&#35748;&#20540;&#26159;false&#65292;&#20351;&#29992;&#28857;&#21040;&#28857;&#30340;&#22495;&#65292;&#20063;&#23601;&#26159;&#38431;&#21015;&#12290;&#22312;1.0.2&#30340;&#23454;&#29616;&#20013;&#65292;&#36825;&#20010;&#23646;&#24615;&#20540;&#29992;&#26469;&#20915;&#23450; <tt class="classname">JmsTemplate</tt> &#23558;&#28040;&#24687;&#21457;&#36865;&#21040;&#19968;&#20010; <tt class="interfacename">Queue</tt> &#36824;&#26159;&#19968;&#20010; <tt class="interfacename">Topic</tt>&#12290;&#36825;&#20010;&#26631;&#24535;&#22312;1.1&#30340;&#23454;&#29616;&#20013;&#23545;&#21457;&#36865;&#25805;&#20316;&#27809;&#26377;&#24433;&#21709;&#12290;&#28982;&#32780;&#65292;&#22312;&#36825;&#20004;&#20010;JMS&#29256;&#26412;&#20013;&#65292;&#36825;&#20010;&#23646;&#24615;&#20915;&#23450;&#20102;&#36890;&#36807;&#25509;&#21475; <tt class="interfacename">DestinationResolver</tt> &#30340;&#23454;&#29616;&#26469;&#20915;&#23450;&#22914;&#20309;&#35299;&#26512;&#21160;&#24577;&#28040;&#24687;&#30446;&#30340;&#22320;&#12290; 
      	</p><p>&#20320;&#36824;&#21487;&#20197;&#36890;&#36807;&#23646;&#24615; <span class="property">defaultDestination</span> &#37197;&#32622;&#19968;&#20010;&#24102;&#26377;&#40664;&#35748;&#30446;&#30340;&#22320;&#30340; <tt class="classname">JmsTemplate</tt>&#12290;&#19981;&#25351;&#26126;&#30446;&#30340;&#22320;&#30340;&#21457;&#36865;&#21644;&#25509;&#21463;&#25805;&#20316;&#23558;&#20351;&#29992;&#35813;&#40664;&#35748;&#30446;&#30340;&#22320;&#12290; 
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-mdp"></a>19.2.4.&nbsp;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;</h3></div></div><div></div></div><p>&#22312;EJB&#19990;&#30028;&#37324;&#65292;JMS&#28040;&#24687;&#26368;&#24120;&#29992;&#30340;&#21151;&#33021;&#20043;&#19968;&#26159;&#29992;&#20110;&#23454;&#29616;&#28040;&#24687;&#39537;&#21160;Bean&#65288;MDB&#65289;&#12290;Spring&#25552;&#20379;&#20102;&#19968;&#20010;&#26041;&#27861;&#26469;&#21019;&#24314;&#28040;&#24687;&#39537;&#21160;&#30340;POJO&#65288;MDP&#65289;&#65292;&#24182;&#19988;&#19981;&#20250;&#25226;&#29992;&#25143;&#32465;&#23450;&#22312;&#26576;&#20010;EJB&#23481;&#22120;&#19978;&#12290;&#65288;&#20851;&#20110;Spring&#30340;MDP&#25903;&#25345;&#30340;&#32454;&#33410;&#35831;&#21442;&#32771;&#26631;&#39064;&#20026; <a href="jms.html#jms-asynchronousMessageReception" title="19.4.2.&nbsp;&#24322;&#27493;&#25509;&#25910; - &#28040;&#24687;&#39537;&#21160;&#30340;POJO">Section&nbsp;19.4.2, &#8220;&#24322;&#27493;&#25509;&#25910; - &#28040;&#24687;&#39537;&#21160;&#30340;POJO&#8221;</a> &#30340;&#31456;&#33410;&#12290;&#65289;
		</p><p>&#36890;&#24120;&#29992;&#28040;&#24687;&#30417;&#21548;&#22120;&#23481;&#22120;&#20174;JMS&#28040;&#24687;&#38431;&#21015;&#25509;&#25910;&#28040;&#24687;&#24182;&#39537;&#21160;&#34987;&#27880;&#23556;&#36827;&#26469;&#30340;MDP&#12290;&#28040;&#24687;&#30417;&#21548;&#22120;&#23481;&#22120;&#36127;&#36131;&#28040;&#24687;&#25509;&#25910;&#30340;&#22810;&#32447;&#31243;&#22788;&#29702;&#24182;&#20998;&#21457;&#21040;&#21508;MDP&#20013;&#12290;&#19968;&#20010;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;&#26159;MDP&#21644;&#28040;&#24687;&#25552;&#20379;&#32773;&#20043;&#38388;&#30340;&#19968;&#20010;&#20013;&#20171;&#65292;&#29992;&#26469;&#22788;&#29702;&#28040;&#24687;&#25509;&#25910;&#30340;&#27880;&#20876;&#65292;&#20107;&#21153;&#31649;&#29702;&#30340;&#21442;&#19982;&#65292;&#36164;&#28304;&#33719;&#21462;&#21644;&#37322;&#25918;&#65292;&#24322;&#24120;&#36716;&#25442;&#31561;&#31561;&#12290;&#36825;&#20351;&#24471;&#24212;&#29992;&#24320;&#21457;&#20154;&#21592;&#21487;&#20197;&#19987;&#27880;&#20110;&#24320;&#21457;&#21644;&#25509;&#25910;&#28040;&#24687;&#65288;&#21487;&#33021;&#30340;&#21709;&#24212;&#65289;&#30456;&#20851;&#30340;&#65288;&#22797;&#26434;&#65289;&#19994;&#21153;&#36923;&#36753;&#65292;&#25226;&#21644;JMS&#22522;&#30784;&#26694;&#26550;&#26377;&#20851;&#30340;&#26679;&#26495;&#21270;&#30340;&#37096;&#20998;&#22996;&#25176;&#32473;&#26694;&#26550;&#22788;&#29702;&#12290;
		</p><p>Spring&#25552;&#20379;&#20102;&#19977;&#31181; <tt class="classname">AbstractMessageListenerContainer</tt> &#30340;&#23376;&#31867;&#65292;&#27599;&#31181;&#21508;&#26377;&#20854;&#29305;&#28857;&#12290;
		</p><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="jms-mdp-simple"></a>19.2.4.1.&nbsp;<tt class="classname">SimpleMessageListenerContainer</tt></h4></div></div><div></div></div><p>&#36825;&#20010;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;&#26159;&#19977;&#31181;&#20013;&#26368;&#31616;&#21333;&#30340;&#12290;&#23427;&#22312;&#21551;&#21160;&#26102;&#21019;&#24314;&#22266;&#23450;&#25968;&#37327;&#30340;JMS session&#24182;&#22312;&#23481;&#22120;&#30340;&#25972;&#20010;&#29983;&#21629;&#21608;&#26399;&#20013;&#20351;&#29992;&#23427;&#20204;&#12290;&#36825;&#20010;&#31867;&#19981;&#33021;&#21160;&#24577;&#30340;&#36866;&#24212;&#36816;&#34892;&#26102;&#30340;&#35201;&#27714;&#25110;&#21442;&#19982;&#28040;&#24687;&#25509;&#25910;&#30340;&#20107;&#21153;&#22788;&#29702;&#12290;&#28982;&#32780;&#23427;&#23545;JMS&#25552;&#20379;&#32773;&#30340;&#35201;&#27714;&#20063;&#26368;&#20302;&#12290;&#23427;&#21482;&#38656;&#35201;&#31616;&#21333;&#30340;JMS API&#12290;
			</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="jms-mdp-default"></a>19.2.4.2.&nbsp;<tt class="classname">DefaultMessageListenerContainer</tt></h4></div></div><div></div></div><p>&#36825;&#20010;&#28040;&#24687;&#20390;&#21548;&#22120;&#20351;&#29992;&#30340;&#26368;&#22810;&#12290;&#21644; <tt class="classname">SimpleMessageListenerContainer</tt> &#30456;&#21453;&#65292;&#36825;&#20010;&#23376;&#31867;&#21487;&#20197;&#21160;&#24577;&#36866;&#24212;&#36816;&#34892;&#26102;&#20399;&#30340;&#35201;&#27714;&#65292;&#20063;&#21487;&#20197;&#21442;&#19982;&#20107;&#21153;&#31649;&#29702;&#12290;&#27599;&#20010;&#25910;&#21040;&#30340;&#28040;&#24687;&#37117;&#27880;&#20876;&#21040;&#19968;&#20010;XA&#20107;&#21153;&#20013;&#65288;&#22914;&#26524;&#20351;&#29992; <tt class="classname">JtaTransactionManager</tt> &#37197;&#32622;&#36807;&#65289;&#65292;&#36825;&#26679;&#23601;&#21487;&#20197;&#21033;&#29992;XA&#20107;&#21153;&#35821;&#20041;&#30340;&#20248;&#21183;&#20102;&#12290;&#36825;&#20010;&#31867;&#22312;&#23545;JMS&#25552;&#20379;&#32773;&#30340;&#20302;&#35201;&#27714;&#21644;&#25552;&#20379;&#21253;&#25324;&#20107;&#21153;&#21442;&#20110;&#31561;&#30340;&#24378;&#22823;&#21151;&#33021;&#19978;&#21462;&#24471;&#20102;&#24456;&#22909;&#30340;&#24179;&#34913;&#12290;
				</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h4 class="title"><a name="jms-mdp-server-session"></a>19.2.4.3.&nbsp;<tt class="classname">ServerSessionMessageListenerContainer</tt></h4></div></div><div></div></div><p>&#36825;&#20010;&#30417;&#21548;&#22120;&#23481;&#22120;&#21033;&#29992;JMS ServerSessionPool SPI&#21160;&#24577;&#31649;&#29702;JMS Session&#12290;
			     &#20351;&#29992;&#32773;&#21508;&#31181;&#28040;&#24687;&#30417;&#21548;&#22120;&#21487;&#20197;&#33719;&#24471;&#36816;&#34892;&#26102;&#21160;&#24577;&#35843;&#20248;&#21151;&#33021;&#65292;&#20294;&#26159;&#36825;&#20063;&#35201;&#27714;JMS&#25552;&#20379;&#32773;&#25903;&#25345;ServerSessionPool SPI&#12290;&#22914;&#26524;&#19981;&#38656;&#35201;&#36816;&#34892;&#26102;&#24615;&#33021;&#35843;&#25972;&#65292;&#35831;&#20351;&#29992; <tt class="classname">DefaultMessageListenerContainer</tt> &#25110; <tt class="classname">SimpleMessageListenerContainer</tt>&#12290;
			     </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-tx"></a>19.2.5.&nbsp;&#20107;&#21153;&#31649;&#29702;</h3></div></div><div></div></div><p>Spring&#25552;&#20379;&#20102; <tt class="classname">JmsTransactionManager</tt> &#20026;&#21333;&#20010;JMS <tt class="classname">ConnectionFactory</tt> &#31649;&#29702;&#20107;&#21153;&#12290;&#36825;&#23558;&#20801;&#35768;JMS&#24212;&#29992;&#21033;&#29992; <a href="transaction.html" title="Chapter&nbsp;9.&nbsp;&#20107;&#21153;&#31649;&#29702;">Chapter&nbsp;9, <i>&#20107;&#21153;&#31649;&#29702;</i></a> &#20013;&#25551;&#36848;&#30340;Spring&#30340;&#20107;&#21153;&#31649;&#29702;&#21151;&#33021;&#12290;<tt class="classname">JmsTransactionManager</tt> &#32465;&#23450; <tt class="classname">ConnectionFactory</tt> &#30340;&#19968;&#20010;Connection/Session&#23545;&#21040;&#32447;&#31243;&#19978;&#65292;&#26469;&#25552;&#20379;&#26412;&#22320;&#36164;&#28304;&#20107;&#21153;&#12290;<tt class="classname">JmsTemplate</tt> &#33258;&#21160;&#26816;&#27979;&#21040;&#36825;&#20123;&#20107;&#21153;&#24615;&#36164;&#28304;&#20174;&#32780;&#23545;&#23427;&#20204;&#36827;&#34892;&#25805;&#20316;&#12290;
            </p><p>&#22312;Java EE&#29615;&#22659;&#20013;&#65292;<tt class="classname">SingleConnectionFactory</tt>&#23558;&#25226;Connection&#21644;Session&#25918;&#21040;&#32531;&#20914;&#27744;&#20013;&#65292;&#22240;&#27492;&#36825;&#20123;&#36164;&#28304;&#22312;&#20107;&#21153;&#20013;&#24471;&#21040;&#20102;&#26377;&#25928;&#30340;&#22797;&#29992;&#12290;&#22312;&#29420;&#31435;&#29615;&#22659;&#20013;&#20351;&#29992;Spring&#30340; <tt class="classname">SingleConnectionFactory</tt> &#20250;&#23384;&#22312;&#20849;&#20139;&#30340;JMS <tt class="classname">Connection</tt>&#65292;&#20294;&#27599;&#20010;&#20107;&#21153;&#26377;&#33258;&#24049;&#29420;&#31435;&#30340; <tt class="classname">Session</tt>&#12290;&#21478;&#22806;&#21487;&#20197;&#32771;&#34385;&#20351;&#29992;&#20379;&#24212;&#21830;&#29305;&#23450;&#30340;&#27744;&#36866;&#37197;&#22120;,&#65292;&#22914;ActiveMQ&#30340; <tt class="classname">PooledConnectionFactory</tt> &#31867;&#12290;
           </p><p><tt class="classname">JmsTemplate</tt> &#20063;&#21487;&#20197;&#21644; <tt class="classname">JtaTransactionManager</tt> &#20197;&#21450;&#20855;&#26377;XA&#33021;&#21147;&#30340;JMS <tt class="classname">ConnectionFactory</tt>&#19968;&#36215;&#20351;&#29992;&#26469;&#25552;&#20379;&#20998;&#24067;&#24335;&#20107;&#21153;&#12290;&#35760;&#20303;&#36825;&#38656;&#35201;&#20351;&#29992;JTA&#20107;&#21153;&#31649;&#29702;&#22120;&#25110;&#21512;&#36866;&#30340;&#21487;&#37197;&#32622;&#30340;XA ConnectionFactory&#65281;&#65288;&#21442;&#32771;&#20320;&#25152;&#20351;&#29992;&#30340;J2EE&#26381;&#21153;&#22120;/JMS&#20379;&#24212;&#21830;&#30340;&#25991;&#26723;&#12290;&#65289;
            </p><p>&#24403;&#20351;&#29992;JMS API&#20174;&#19968;&#20010; <tt class="classname">Connection</tt> &#20013;&#21019;&#24314; <tt class="classname">Session</tt> &#26102;&#65292;&#22312;&#21463;&#31649;&#29702;&#30340;&#21644;&#38750;&#21463;&#31649;&#29702;&#30340;&#20107;&#21153;&#29615;&#22659;&#19979;&#37325;&#29992;&#20195;&#30721;&#20250;&#21487;&#33021;&#20250;&#35753;&#20154;&#36855;&#24785;&#12290;&#36825;&#26159;&#22240;&#20026;JMS API&#21482;&#26377;&#19968;&#20010;&#24037;&#21378;&#26041;&#27861;&#26469;&#21019;&#24314; <tt class="classname">Session</tt> &#65292;&#24182;&#19988;&#23427;&#38656;&#35201;&#29992;&#20110;&#20107;&#21153;&#21644;&#27169;&#24335;&#30830;&#35748;&#30340;&#20540;&#12290;&#22312;&#21463;&#31649;&#29702;&#30340;&#29615;&#22659;&#19979;&#65292;&#30001;&#20107;&#21153;&#32467;&#26500;&#29615;&#22659;&#36127;&#36131;&#35774;&#32622;&#36825;&#20123;&#20540;&#65292;&#36825;&#26679;&#22312;&#20379;&#24212;&#21830;&#21253;&#35013;&#30340;JMS&#36830;&#25509;&#20013;&#21487;&#20197;&#24573;&#30053;&#36825;&#20123;&#20540;&#12290;&#24403;&#22312;&#19968;&#20010;&#38750;&#31649;&#29702;&#24615;&#30340;&#29615;&#22659;&#20013;&#20351;&#29992; <tt class="classname">JmsTemplate</tt> &#26102;&#65292;&#20320;&#21487;&#20197;&#36890;&#36807;&#20351;&#29992;&#23646;&#24615; <tt class="classname">SessionTransacted</tt> &#21644; <tt class="classname">SessionAcknowledgeMode</tt> &#26469;&#25351;&#23450;&#36825;&#20123;&#20540;&#12290;&#24403; <tt class="classname">JmsTemplate</tt> &#37197;&#21512; <tt class="classname">PlatformTransactionManager</tt> &#20351;&#29992;&#26102;&#65292;&#27169;&#26495;&#23558;&#19968;&#30452;&#34987;&#36171;&#20104;&#19968;&#20010;&#20107;&#21153;&#24615;JMS&#30340; <tt class="classname">Session</tt>&#12290; 
			</p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-sending"></a>19.3.&nbsp;&#21457;&#36865;&#28040;&#24687;</h2></div></div><div></div></div><p><tt class="classname">JmsTemplate</tt> &#21253;&#21547;&#35768;&#22810;&#26041;&#20415;&#30340;&#26041;&#27861;&#26469;&#21457;&#36865;&#28040;&#24687;&#12290;&#26377;&#20123;&#21457;&#36865;&#26041;&#27861;&#21487;&#20197;&#20351;&#29992; <tt class="classname">javax.jms.Destination</tt> &#23545;&#35937;&#25351;&#23450;&#30446;&#30340;&#22320;&#65292;&#20063;&#21487;&#20197;&#20351;&#29992;&#23383;&#31526;&#20018;&#22312;JNDI&#20013;&#26597;&#25214;&#30446;&#30340;&#22320;&#12290;&#27809;&#26377;&#30446;&#30340;&#22320;&#21442;&#25968;&#30340;&#21457;&#36865;&#26041;&#27861;&#20351;&#29992;&#40664;&#35748;&#30340;&#30446;&#30340;&#22320;&#12290;&#36825;&#37324;&#26377;&#20010;&#20363;&#23376;&#20351;&#29992;1.0.2&#29256;&#30340;JMS&#23454;&#29616;&#21457;&#36865;&#28040;&#24687;&#21040;&#19968;&#20010;&#38431;&#21015;&#12290; 
      </p><pre class="programlisting">import javax.jms.ConnectionFactory;
import javax.jms.JMSException;
import javax.jms.Message;
import javax.jms.Queue;
import javax.jms.Session;

import org.springframework.jms.core.MessageCreator;
import org.springframework.jms.core.JmsTemplate;
import org.springframework.jms.core.JmsTemplate102;

public class JmsQueueSender {

    private JmsTemplate jmsTemplate;
    private Queue queue;

    public void setConnectionFactory(ConnectionFactory cf) {
        this.jmsTemplate = new JmsTemplate102(cf, false);
    }

    public void setQueue(Queue queue) {
        this.queue = queue;
    }

    public void simpleSend() {
        this.jmsTemplate.send(this.queue, new MessageCreator() {
            public Message createMessage(Session session) throws JMSException {
              return session.createTextMessage("hello queue world");
            }
        });
    }
}</pre><p>&#36825;&#20010;&#20363;&#23376;&#20351;&#29992; <tt class="classname">MessageCreator</tt> &#22238;&#35843;&#25509;&#21475;&#20174;&#25552;&#20379;&#30340; <tt class="classname">Session</tt> &#23545;&#35937;&#20013;&#21019;&#24314;&#19968;&#20010;&#25991;&#26412;&#28040;&#24687;&#65292;&#24182;&#19988;&#36890;&#36807;&#19968;&#20010; <tt class="classname">ConnectionFactory</tt> &#30340;&#24341;&#29992;&#21644;&#25351;&#23450;&#28040;&#24687;&#22495;&#30340;&#24067;&#23572;&#20540;&#26469;&#21019;&#24314; <tt class="classname">JmsTemplate</tt>&#12290;&#25552;&#20379;&#20102;&#19968;&#20010;&#26080;&#21442;&#25968;&#30340;&#26500;&#36896;&#22120;&#21644; <span class="property">connectionFactory</span> / <span class="property">queue</span> Bean&#23646;&#24615;&#24182;&#21487;&#29992;&#20110;&#21019;&#24314;&#23454;&#20363;&#65288;&#20351;&#29992;&#19968;&#20010;BeanFactory&#25110;&#32773;&#26222;&#36890;Java&#20195;&#30721;&#65289;&#12290;&#25110;&#32773;&#32771;&#34385;&#20174;Spring&#30340;&#22522;&#31867; <tt class="classname">JmsGatewaySupport</tt>&#65292;&#23427;&#23545;JMS&#37197;&#32622;&#20855;&#26377;&#20869;&#32622;&#30340;Bean&#23646;&#24615;&#65292;&#32487;&#25215;&#19968;&#20010;&#31867;&#12290;
      </p><p>&#24403;&#22312;&#24212;&#29992;&#19978;&#19979;&#25991;&#20013;&#37197;&#32622;JMS 1.0.2&#26102;&#65292;&#37325;&#35201;&#30340;&#26159;&#35760;&#24471;&#35774;&#23450;&#24067;&#23572;&#23646;&#24615; <span class="property">pubSubDomain</span> &#30340;&#20540;&#20197;&#25351;&#26126;&#20320;&#26159;&#35201;&#21457;&#36865;&#21040;&#38431;&#21015;&#36824;&#26159;&#20027;&#39064;&#12290;</p><p>&#26041;&#27861; <tt class="methodname">send(String destinationName, MessageCreator creator)</tt> &#35753;&#20320;&#21033;&#29992;&#30446;&#30340;&#22320;&#30340;&#23383;&#31526;&#20018;&#21517;&#23383;&#21457;&#36865;&#28040;&#24687;&#12290;&#22914;&#26524;&#36825;&#20010;&#21517;&#23383;&#22312;JNDI&#20013;&#27880;&#20876;&#65292;&#20320;&#24212;&#24403;&#23558;&#27169;&#26495;&#20013;&#30340; <span class="property">destinationResolver</span> &#23646;&#24615;&#35774;&#32622;&#20026; <tt class="classname">JndiDestinationResolver</tt> &#30340;&#19968;&#20010;&#23454;&#20363;&#12290;</p><p>&#22914;&#26524;&#20320;&#21019;&#24314; <tt class="classname">JmsTemplate</tt> &#24182;&#25351;&#23450;&#19968;&#20010;&#40664;&#35748;&#30340;&#30446;&#30340;&#22320;&#65292;<tt class="methodname">send(MessageCreator c)</tt> &#21457;&#36865;&#28040;&#24687;&#21040;&#36825;&#20010;&#30446;&#30340;&#22320;&#12290; 
      </p><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-msg-conversion"></a>19.3.1.&nbsp;&#20351;&#29992;&#28040;&#24687;&#36716;&#25442;&#22120;</h3></div></div><div></div></div><p>&#20026;&#20415;&#20110;&#21457;&#36865;&#39046;&#22495;&#27169;&#22411;&#23545;&#35937;&#65292;<tt class="classname">JmsTemplate</tt> &#26377;&#22810;&#31181;&#20197;&#19968;&#20010;Java&#23545;&#35937;&#20026;&#21442;&#25968;&#24182;&#20570;&#20026;&#28040;&#24687;&#25968;&#25454;&#20869;&#23481;&#30340;&#21457;&#36865;&#26041;&#27861;&#12290;<tt class="classname">JmsTemplate</tt> &#37324;&#21487;&#37325;&#36733;&#30340;&#26041;&#27861; <tt class="methodname">convertAndSend</tt> &#21644; <tt class="methodname">receiveAndConvert</tt> &#23558;&#36716;&#25442;&#30340;&#36807;&#31243;&#22996;&#25176;&#32473;&#25509;&#21475; <tt class="literal">MessageConverter</tt> &#30340;&#19968;&#20010;&#23454;&#20363;&#12290;&#36825;&#20010;&#25509;&#21475;&#23450;&#20041;&#20102;&#19968;&#20010;&#31616;&#21333;&#30340;&#21512;&#32422;&#29992;&#26469;&#22312;Java&#23545;&#35937;&#21644;JMS&#28040;&#24687;&#38388;&#36827;&#34892;&#36716;&#25442;&#12290;&#32570;&#30465;&#30340;&#23454;&#29616; <tt class="classname">SimpleMessageConverter</tt> &#25903;&#25345; <tt class="classname">String</tt> &#21644; <tt class="classname">TextMessage</tt>&#65292;<tt class="classname">byte[]</tt> &#21644; <tt class="classname">BytesMesssage</tt>&#65292;&#20197;&#21450; <tt class="classname">java.util.Map</tt> &#21644; <tt class="classname">MapMessage</tt> &#20043;&#38388;&#30340;&#36716;&#25442;&#12290;&#20351;&#29992;&#36716;&#25442;&#22120;&#65292;&#21487;&#20197;&#20351;&#20320;&#21644;&#20320;&#30340;&#24212;&#29992;&#20851;&#27880;&#20110;&#36890;&#36807;JMS&#25509;&#25910;&#21644;&#21457;&#36865;&#30340;&#19994;&#21153;&#23545;&#35937;&#32780;&#19981;&#29992;&#25805;&#24515;&#23427;&#26159;&#20855;&#20307;&#22914;&#20309;&#34920;&#36798;&#25104;JMS&#28040;&#24687;&#30340;&#12290;
  		</p><p>&#30446;&#21069;&#30340;&#27801;&#31665;&#27169;&#22411;&#21253;&#25324;&#19968;&#20010; <tt class="classname">MapMessageConverter</tt>&#65292;&#23427;&#20351;&#29992;&#21453;&#23556;&#36716;&#25442;JavaBean&#21644; <tt class="classname">MapMessage</tt>&#12290;&#20854;&#20182;&#27969;&#34892;&#21487;&#36873;&#30340;&#23454;&#29616;&#26041;&#24335;&#21253;&#25324;&#20351;&#29992;&#24050;&#23384;&#22312;&#30340;XML&#32534;&#32452;&#30340;&#21253;&#65292;&#20363;&#22914;JAXB&#12289;Castor&#12289;XMLBeans&#25110;XStream&#30340;&#36716;&#25442;&#22120;&#26469;&#21019;&#24314;&#19968;&#20010;&#34920;&#31034;&#23545;&#35937;&#30340; <tt class="interfacename">TextMessage</tt>&#12290;
      </p><p>&#20026;&#26041;&#20415;&#37027;&#20123;&#19981;&#33021;&#20197;&#36890;&#29992;&#26041;&#24335;&#23553;&#35013;&#22312;&#36716;&#25442;&#31867;&#37324;&#30340;&#28040;&#24687;&#23646;&#24615;&#65292;&#28040;&#24687;&#22836;&#21644;&#28040;&#24687;&#20307;&#30340;&#35774;&#32622;&#65292;&#36890;&#36807; <tt class="interfacename">MessagePostProcessor</tt> &#25509;&#21475;&#20320;&#21487;&#20197;&#22312;&#28040;&#24687;&#34987;&#36716;&#25442;&#21518;&#24182;&#19988;&#22312;&#21457;&#36865;&#21069;&#35775;&#38382;&#35813;&#28040;&#24687;&#12290;&#19979;&#20363;&#23637;&#31034;&#20102;&#22914;&#20309;&#22312; <tt class="interfacename">java.util.Map</tt> &#24050;&#32463;&#36716;&#25442;&#25104;&#19968;&#20010;&#28040;&#24687;&#21518;&#26356;&#25913;&#28040;&#24687;&#22836;&#21644;&#23646;&#24615;&#12290;
      </p><pre class="programlisting">public void sendWithConversion() {
    Map map = new HashMap();
    map.put("Name", "Mark");
    map.put("Age", new Integer(47));
    jmsTemplate.convertAndSend("testQueue", map, new MessagePostProcessor() {
        public Message postProcessMessage(Message message) throws JMSException {
            message.setIntProperty("AccountID", 1234);
            message.setJMSCorrelationID("123-00001");
            return message;
        }
    });
}</pre><p>&#36825;&#23558;&#20135;&#29983;&#19968;&#20010;&#22914;&#19979;&#30340;&#28040;&#24687;&#26684;&#24335;:</p><pre class="programlisting">MapMessage={
    Header={
        ... standard headers ...
        CorrelationID={123-00001}
    }
    Properties={
        AccountID={Integer:1234}
    }
    Fields={
        Name={String:Mark}
        Age={Integer:47}
    } 
}</pre></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-callbacks"></a>19.3.2.&nbsp;<tt class="interfacename">SessionCallback</tt> &#21644; <tt class="interfacename">ProducerCallback</tt></h3></div></div><div></div></div><p>&#34429;&#28982;send&#25805;&#20316;&#36866;&#29992;&#20110;&#35768;&#22810;&#24120;&#35265;&#30340;&#20351;&#29992;&#22330;&#26223;&#65292;&#20294;&#26159;&#26377;&#26102;&#20320;&#38656;&#35201;&#22312;&#19968;&#20010;JMS <tt class="interfacename">Session</tt> &#25110;&#32773; <tt class="interfacename">MessageProducer</tt> &#19978;&#25191;&#34892;&#22810;&#20010;&#25805;&#20316;&#12290;&#25509;&#21475; <tt class="interfacename">SessionCallback</tt> &#21644; <tt class="interfacename">ProducerCallback</tt> &#20998;&#21035;&#25552;&#20379;&#20102;JMS <tt class="interfacename">Session</tt> &#21644; <tt class="interfacename">Session</tt> / <tt class="interfacename">MessageProducer</tt> &#23545;&#12290;<tt class="classname">JmsTemplate</tt> &#19978;&#30340; <tt class="methodname">execute()</tt> &#26041;&#27861;&#25191;&#34892;&#36825;&#20123;&#22238;&#35843;&#26041;&#27861;&#12290;
        </p></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-receiving"></a>19.4.&nbsp;&#25509;&#25910;&#28040;&#24687;</h2></div></div><div></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-receiving-sync"></a>19.4.1.&nbsp;&#21516;&#27493;&#25509;&#25910;</h3></div></div><div></div></div><p>&#34429;&#28982;JMS&#19968;&#33324;&#37117;&#21644;&#24322;&#27493;&#22788;&#29702;&#30456;&#20851;&#65292;&#20294;&#23427;&#20063;&#21487;&#20197;&#21516;&#27493;&#30340;&#26041;&#24335;&#20351;&#29992;&#28040;&#24687;&#12290;&#21487;&#37325;&#36733;&#30340; <tt class="methodname">receive(..)</tt> &#26041;&#27861;&#25552;&#20379;&#20102;&#36825;&#31181;&#21151;&#33021;&#12290;&#22312;&#21516;&#27493;&#25509;&#25910;&#20013;&#65292;&#25509;&#25910;&#32447;&#31243;&#34987;&#38459;&#22622;&#30452;&#33267;&#33719;&#24471;&#19968;&#20010;&#28040;&#24687;&#65292;&#26377;&#21487;&#33021;&#20986;&#29616;&#32447;&#31243;&#34987;&#26080;&#38480;&#38459;&#22622;&#30340;&#21361;&#38505;&#24773;&#20917;&#12290;&#23646;&#24615; <span class="property">receiveTimeout</span> &#25351;&#23450;&#20102;&#25509;&#25910;&#22120;&#21487;&#31561;&#24453;&#28040;&#24687;&#30340;&#24310;&#26102;&#26102;&#38388;&#12290;
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-asynchronousMessageReception"></a>19.4.2.&nbsp;&#24322;&#27493;&#25509;&#25910; - &#28040;&#24687;&#39537;&#21160;&#30340;POJO</h3></div></div><div></div></div><p>&#31867;&#20284;&#20110;EJB&#19990;&#30028;&#37324;&#27969;&#34892;&#30340;&#28040;&#24687;&#39537;&#21160;Bean&#65288;MDB&#65289;&#65292;&#28040;&#24687;&#39537;&#21160;POJO&#65288;MDP&#65289;&#20316;&#20026;JMS&#28040;&#24687;&#30340;&#25509;&#25910;&#22120;&#12290;MDP&#30340;&#19968;&#20010;&#32422;&#26463;&#65288;&#20294;&#20063;&#35831;&#30475;&#19979;&#38754;&#30340;&#26377;&#20851; <tt class="interfacename">javax.jms.MessageListener</tt> &#31867;&#30340;&#35752;&#35770;&#65289;&#26159;&#23427;&#24517;&#39035;&#23454;&#29616; <tt class="interfacename">javax.jms.MessageListener</tt> &#25509;&#21475;&#12290;&#21478;&#22806;&#24403;&#20320;&#30340;POJO&#23558;&#20197;&#22810;&#32447;&#31243;&#30340;&#26041;&#24335;&#25509;&#25910;&#28040;&#24687;&#26102;&#24517;&#39035;&#30830;&#20445;&#20320;&#30340;&#20195;&#30721;&#26159;&#32447;&#31243;-&#23433;&#20840;&#30340;&#12290;
  		</p><p>&#20197;&#19979;&#26159;MDP&#30340;&#19968;&#20010;&#31616;&#21333;&#23454;&#29616;:</p><pre class="programlisting">import javax.jms.JMSException;
import javax.jms.Message;
import javax.jms.MessageListener;
import javax.jms.TextMessage;

public class ExampleListener implements MessageListener {

    public void onMessage(Message message) {
        if (message instanceof TextMessage) {
            try {
                System.out.println(((TextMessage) message).getText());
            }
            catch (JMSException ex) {
                throw new RuntimeException(ex);
            }
        }
        else {
            throw new IllegalArgumentException("Message must be of type TextMessage");
        }
    }
}</pre><p>&#19968;&#26086;&#20320;&#23454;&#29616;&#20102; <tt class="interfacename">MessageListener</tt> &#21518;&#23601;&#21487;&#20197;&#21019;&#24314;&#19968;&#20010;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;&#12290;
</p><p>&#35831;&#30475;&#19979;&#38754;&#20363;&#23376;&#26159;&#22914;&#20309;&#23450;&#20041;&#21644;&#37197;&#32622;&#19968;&#20010;&#38543;Sping&#21457;&#34892;&#30340;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;&#30340;&#65288;&#36825;&#20010;&#20363;&#23376;&#29992; <tt class="classname">DefaultMessageListenerContainer</tt>&#65289;
</p><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">&lt;!-- this is the Message Driven POJO (MDP) --&gt;</span></i>
&lt;bean id="messageListener" class="jmsexample.ExampleListener" /&gt;

<i class="lineannotation"><span class="lineannotation">&lt;!-- and this is the message listener container --&gt;</span></i>
&lt;bean id="jmsContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer"&gt;
    &lt;property name="connectionFactory" ref="connectionFactory"/&gt;
    &lt;property name="destination" ref="destination"/&gt;
    <span class="bold"><b>&lt;property name="messageListener" ref="messageListener" /&gt;</b></span>
&lt;/bean&gt;</pre><p>&#20851;&#20110;&#21508;&#20010;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;&#23454;&#29616;&#30340;&#29305;&#33394;&#35831;&#21442;&#38405;&#30456;&#20851;&#30340;Spring Javadoc&#25991;&#26723;&#12290;</p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-receiving-async-session-aware-message-listener"></a>19.4.3.&nbsp;<tt class="interfacename">SessionAwareMessageListener</tt>&#25509;&#21475;</h3></div></div><div></div></div><p><tt class="interfacename">SessionAwareMessageListener</tt> &#25509;&#21475;&#26159;&#19968;&#20010;Spring&#19987;&#38376;&#29992;&#26469;&#25552;&#20379;&#31867;&#20284;&#20110;JMS <tt class="interfacename">MessageListener</tt> &#30340;&#25509;&#21475;&#65292;&#20063;&#25552;&#20379;&#20102;&#20174;&#25509;&#25910; <tt class="interfacename">Message</tt> &#26469;&#35775;&#38382;JMS <tt class="interfacename">Session</tt> &#30340;&#28040;&#24687;&#22788;&#29702;&#26041;&#27861;&#12290;
</p><pre class="programlisting">package org.springframework.jms.listener;

public interface SessionAwareMessageListener {

    void onMessage(Message message, Session session) <span class="bold"><b>throws JMSException</b></span>;
}</pre><p>&#22914;&#26524;&#20320;&#24076;&#26395;&#20320;&#30340;MDP&#21487;&#20197;&#21709;&#24212;&#25152;&#26377;&#25509;&#25910;&#21040;&#30340;&#28040;&#24687;&#65288;&#20351;&#29992; <tt class="literal">onMessage(Message, Session)</tt> &#26041;&#27861;&#25552;&#20379;&#30340; <tt class="interfacename">Session</tt>&#65289;&#37027;&#20040;&#20320;&#21487;&#20197;&#36873;&#25321;&#35753;&#20320;&#30340;MDP&#23454;&#29616;&#36825;&#20010;&#25509;&#21475;&#65288;&#20248;&#20808;&#20110;&#26631;&#20934;&#30340;JMS <tt class="interfacename">MessageListener</tt> &#25509;&#21475;)&#12290;&#25152;&#26377;&#38543;Spring&#21457;&#34892;&#30340;&#25903;&#25345;MDP&#30340;&#28040;&#24687;&#20390;&#21548;&#23481;&#22120;&#37117;&#25903;&#25345; <tt class="interfacename">MessageListener</tt> &#25110; <tt class="interfacename">SessionAwareMessageListener</tt> &#25509;&#21475;&#30340;&#23454;&#29616;&#12290;&#35201;&#27880;&#24847;&#30340;&#26159;&#23454;&#29616;&#20102; <tt class="interfacename">SessionAwareMessageListener</tt> &#25509;&#21475;&#30340;&#31867;&#36890;&#36807;&#25509;&#21475;&#21644;Spring&#26377;&#20102;&#32806;&#21512;&#12290;&#26159;&#21542;&#36873;&#25321;&#20351;&#29992;&#23427;&#23436;&#20840;&#21462;&#20915;&#20110;&#24320;&#21457;&#32773;&#25110;&#26550;&#26500;&#24072;&#12290;
        </p><p>&#35831;&#27880;&#24847; <tt class="interfacename">SessionAwareMessageListener</tt> &#25509;&#21475;&#30340; <tt class="literal">'onMessage(..)'</tt> &#26041;&#27861;&#20250;&#25243;&#20986; <tt class="classname">JMSException</tt>&#24322;&#24120;&#12290;&#21644;&#26631;&#20934;JMS <tt class="interfacename">MessageListener</tt> &#25509;&#21475;&#30456;&#21453;&#65292;&#24403;&#20351;&#29992; <tt class="interfacename">SessionAwareMessageListener</tt> &#25509;&#21475;&#26102;&#65292;&#23458;&#25143;&#31471;&#20195;&#30721;&#36127;&#36131;&#22788;&#29702;&#20219;&#20309;&#25243;&#20986;&#30340;&#24322;&#24120;&#12290;
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-receiving-async-message-listener-adapter"></a>19.4.4.&nbsp;<tt class="classname">MessageListenerAdapter</tt></h3></div></div><div></div></div><p><tt class="classname">MessageListenerAdapter</tt> &#31867;&#26159;Spring&#30340;&#24322;&#27493;&#25903;&#25345;&#28040;&#24687;&#31867;&#20013;&#30340;&#19981;&#21464;&#31867;&#65288;final class&#65289;&#65306;&#31616;&#32780;&#35328;&#20043;&#65292;&#23427;&#20801;&#35768;&#20320;&#20960;&#20046;&#23558; <span class="emphasis"><em>&#20219;&#24847;</em></span> &#19968;&#20010;&#31867;&#20570;&#20026;MDP&#26174;&#38706;&#20986;&#26469;&#65288;&#24403;&#28982;&#26377;&#26576;&#20123;&#38480;&#21046;&#65289;&#12290;
  	    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22914;&#26524;&#20320;&#20351;&#29992;JMS 1.0.2 API&#65292;&#20320;&#23558;&#20351;&#29992;&#21644; <tt class="classname">MessageListenerAdapter</tt> &#19968;&#26679;&#21151;&#33021;&#30340;&#31867; <tt class="classname">MessageListenerAdapter102</tt>&#12290;
  	        </p></td></tr></table></div><p>&#32771;&#34385;&#22914;&#19979;&#25509;&#21475;&#23450;&#20041;&#12290;&#27880;&#24847;&#34429;&#28982;&#36825;&#20010;&#25509;&#21475;&#26082;&#19981;&#26159;&#20174; <tt class="interfacename">MessageListener</tt> &#20063;&#19981;&#26159;&#20174; <tt class="interfacename">SessionAwareMessageListener</tt> &#32487;&#25215;&#26469;&#24471;&#65292;&#20294;&#36890;&#36807; <tt class="classname">MessageListenerAdapter</tt> &#31867;&#20381;&#28982;&#21487;&#20197;&#24403;&#20316;&#19968;&#20010;MDP&#26469;&#20351;&#29992;&#12290;&#21516;&#26102;&#20063;&#35831;&#27880;&#24847;&#21508;&#31181;&#28040;&#24687;&#22788;&#29702;&#26041;&#27861;&#26159;&#22914;&#20309;&#26681;&#25454;&#20182;&#20204;&#21487;&#20197;&#25509;&#25910;&#24182;&#22788;&#29702;&#28040;&#24687;&#30340;&#20869;&#23481;&#26469;&#36827;&#34892;&#24378;&#31867;&#22411;&#21305;&#37197;&#30340;&#12290;
        </p><pre class="programlisting">public interface MessageDelegate {

    void handleMessage(String message);

    void handleMessage(Map message);

    void handleMessage(byte[] message);

    void handleMessage(Serializable message);
}</pre><pre class="programlisting">public class DefaultMessageDelegate implements MessageDelegate {
    <i class="lineannotation"><span class="lineannotation">// implementation elided for clarity...</span></i>
}</pre><p>&#29305;&#21035;&#35831;&#27880;&#24847;&#65292;&#19978;&#38754;&#30340; <tt class="interfacename">MessageDelegate</tt> &#25509;&#21475;&#65288;&#19978;&#25991;&#20013; <tt class="classname">DefaultMessageDelegate</tt> &#31867;&#65289;&#30340;&#23454;&#29616;&#23436;&#20840; <span class="emphasis"><em>&#19981;</em></span> &#20381;&#36182;&#20110;JMS&#12290;&#23427;&#26159;&#19968;&#20010;&#30495;&#27491;&#30340;POJO&#65292;&#25105;&#20204;&#21487;&#20197;&#36890;&#36807;&#22914;&#19979;&#37197;&#32622;&#25226;&#23427;&#35774;&#32622;&#25104;MDP&#12290;
        </p><pre class="programlisting"><i class="lineannotation"><span class="lineannotation">&lt;!-- this is the Message Driven POJO (MDP) --&gt;</span></i>
<span class="bold"><b>&lt;bean id="messageListener" class="org.springframework.jms.listener.adapter.MessageListenerAdapter"&gt;
    &lt;constructor-arg&gt;
        &lt;bean class="jmsexample.DefaultMessageDelegate"/&gt;
    &lt;/constructor-arg&gt;
&lt;/bean&gt;</b></span>

<i class="lineannotation"><span class="lineannotation">&lt;!-- and this is the message listener container... --&gt;</span></i>
&lt;bean id="jmsContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer"&gt;
    &lt;property name="connectionFactory" ref="connectionFactory"/&gt;
    &lt;property name="destination" ref="destination"/&gt;
    <span class="bold"><b>&lt;property name="messageListener" ref="messageListener" /&gt;</b></span>
&lt;/bean&gt;</pre><p>&#19979;&#38754;&#26159;&#21478;&#22806;&#19968;&#20010;&#21482;&#33021;&#22788;&#29702;&#25509;&#25910;JMS <tt class="interfacename">TextMessage</tt> &#28040;&#24687;&#30340;MDP&#31034;&#20363;&#12290;&#27880;&#24847;&#28040;&#24687;&#22788;&#29702;&#26041;&#27861;&#26159;&#22914;&#20309;&#23454;&#38469;&#35843;&#29992; <tt class="literal">'receive'</tt> &#65288;&#22312; <tt class="classname">MessageListenerAdapter</tt> &#20013;&#40664;&#35748;&#30340;&#28040;&#24687;&#22788;&#29702;&#26041;&#27861;&#30340;&#21517;&#23383;&#26159; <tt class="literal">'handleMessage'</tt>&#65289;&#30340;&#65292;&#20294;&#26159;&#23427;&#26159;&#21487;&#37197;&#32622;&#30340;&#65288;&#20320;&#19979;&#38754;&#23601;&#23558;&#30475;&#21040;&#65289;&#12290;&#27880;&#24847; <tt class="literal">'receive(..)'</tt> &#26041;&#27861;&#26159;&#22914;&#20309;&#20351;&#29992;&#24378;&#21046;&#31867;&#22411;&#26469;&#21482;&#25509;&#25910;&#21644;&#22788;&#29702;JMS <tt class="interfacename">TextMessage</tt>&#28040;&#24687;&#30340;&#12290;
        </p><pre class="programlisting">public interface TextMessageDelegate {

    void receive(TextMessage message);
}</pre><pre class="programlisting">public class DefaultTextMessageDelegate implements TextMessageDelegate {
    <i class="lineannotation"><span class="lineannotation">// implementation elided for clarity...</span></i>
}</pre><p>&#36741;&#21161;&#30340; <tt class="classname">MessageListenerAdapter</tt> &#31867;&#37197;&#32622;&#25991;&#20214;&#31867;&#20284;&#22914;&#19979;&#65306;
        </p><pre class="programlisting">&lt;bean id="messageListener" class="org.springframework.jms.listener.adapter.MessageListenerAdapter"&gt;
    &lt;constructor-arg&gt;
        &lt;bean class="jmsexample.DefaultTextMessageDelegate"/&gt;
    &lt;/constructor-arg&gt;
    &lt;property name="defaultListenerMethod" value="receive"/&gt;
    <i class="lineannotation"><span class="lineannotation">&lt;!-- we <span class="bold"><b>don't</b></span> want automatic message context extraction --&gt;</span></i>
    &lt;property name="messageConverter"&gt;
        &lt;null/&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre><p>&#35831;&#27880;&#24847;&#65292;&#22914;&#26524;&#19978;&#38754;&#30340; <tt class="literal">'messageListener'</tt> &#25910;&#21040;&#19968;&#20010;&#19981;&#26159; <tt class="interfacename">TextMessage</tt> &#31867;&#22411;&#30340;JMS <tt class="interfacename">Message</tt>&#65292;&#23558;&#20250;&#20135;&#29983;&#19968;&#20010; <tt class="classname">IllegalStateException</tt> &#24322;&#24120;&#65288;&#38543;&#20043;&#20135;&#29983;&#30340;&#20854;&#20182;&#24322;&#24120;&#21482;&#34987;&#25429;&#33719;&#32780;&#19981;&#22788;&#29702;&#65289;&#12290;
        </p><p><tt class="classname">MessageListenerAdapter</tt> &#36824;&#26377;&#19968;&#20010;&#21151;&#33021;&#23601;&#26159;&#22914;&#26524;&#22788;&#29702;&#26041;&#27861;&#36820;&#22238;&#19968;&#20010;&#38750;&#31354;&#20540;&#65292;&#23427;&#23558;&#33258;&#21160;&#36820;&#22238;&#19968;&#20010;&#21709;&#24212; <tt class="interfacename">&#28040;&#24687;</tt>&#12290;
        </p><p>&#35831;&#30475;&#19979;&#38754;&#30340;&#25509;&#21475;&#21450;&#20854;&#23454;&#29616;&#65306;</p><pre class="programlisting">public interface ResponsiveTextMessageDelegate {

    <i class="lineannotation"><span class="lineannotation"><span class="bold"><b>// notice the return type...</b></span></span></i>
    String receive(TextMessage message);
}</pre><pre class="programlisting">public class DefaultResponsiveTextMessageDelegate implements ResponsiveTextMessageDelegate {
    <i class="lineannotation"><span class="lineannotation">// implementation elided for clarity...</span></i>
}</pre><p>&#22914;&#26524;&#19978;&#38754;&#30340; <tt class="classname">DefaultResponsiveTextMessageDelegate</tt> &#21644; <tt class="classname">MessageListenerAdapter</tt> &#32852;&#21512;&#20351;&#29992;&#65292;&#37027;&#20040;&#20219;&#24847;&#20174;&#25191;&#34892; <tt class="literal">'receive(..)'</tt> &#26041;&#27861;&#36820;&#22238;&#30340;&#38750;&#31354;&#20540;&#37117;&#23558;&#65288;&#32570;&#30465;&#24773;&#20917;&#19979;&#65289;&#36716;&#25442;&#25104;&#19968;&#20010; <tt class="interfacename">TextMessage</tt>&#12290;&#36825;&#20010;&#36820;&#22238;&#30340; <tt class="interfacename">TextMessage</tt> &#23558;&#34987;&#21457;&#36865;&#21040;&#21407;&#26469;&#30340; <tt class="interfacename">Message</tt> &#20013;JMS Reply-To&#23646;&#24615;&#23450;&#20041;&#30340; <tt class="interfacename">&#30446;&#30340;&#22320;</tt>&#65288;&#22914;&#26524;&#23384;&#22312;&#65289;&#65292;&#25110;&#32773;&#26159; <tt class="classname">MessageListenerAdapter</tt> &#35774;&#32622;&#65288;&#22914;&#26524;&#37197;&#32622;&#20102;&#65289;&#30340;&#32570;&#30465; <tt class="interfacename">&#30446;&#30340;&#22320;</tt>&#65307;&#22914;&#26524;&#27809;&#26377;&#23450;&#20041; <tt class="interfacename">&#30446;&#30340;&#22320;</tt>&#65292;&#37027;&#20040;&#23558;&#20135;&#29983;&#19968;&#20010; <tt class="classname">InvalidDestinationException</tt> &#24322;&#24120;&#65288;&#27492;&#24322;&#24120;&#23558;&#19981;&#20250;&#21482;&#34987;&#25429;&#33719;&#32780;&#19981;&#22788;&#29702;&#65292;&#23427; <span class="emphasis"><em>&#23558;</em></span>&#27839;&#30528;&#35843;&#29992;&#22534;&#26632;&#19978;&#20256;&#65289;&#12290;
        </p></div><div class="section" lang="en"><div class="titlepage"><div><div><h3 class="title"><a name="jms-tx-participation"></a>19.4.5.&nbsp;&#20107;&#21153;&#20013;&#30340;&#28040;&#24687;&#22788;&#29702;</h3></div></div><div></div></div><p>&#22312;&#28040;&#24687;&#30417;&#21548;&#22120;&#30340;&#35843;&#29992;&#20013;&#20351;&#29992;&#20107;&#21153;&#21482;&#38656;&#35201;&#37325;&#26032;&#37197;&#32622;&#30417;&#21548;&#22120;&#23481;&#22120;</p><p>&#36890;&#36807;&#30417;&#21548;&#22120;&#23481;&#22120;&#23450;&#20041;&#20013;&#30340; <tt class="literal">sessionTransacted</tt> &#26631;&#35760;&#21487;&#20197;&#36731;&#26494;&#30340;&#28608;&#27963;&#26412;&#22320;&#36164;&#28304;&#20107;&#21153;&#12290;&#27599;&#27425;&#28040;&#24687;&#30417;&#21548;&#22120;&#30340;&#35843;&#29992;&#37117;&#22312;&#28608;&#27963;&#30340;JMS&#20107;&#21153;&#20013;&#25191;&#34892;&#65292;&#25191;&#34892;&#22833;&#36133;&#26102;&#65292;&#28040;&#24687;&#25509;&#25910;&#23558;&#21457;&#29983;&#22238;&#28378;&#12290;&#36825;&#20010;&#26412;&#22320;&#20107;&#21153;&#36824;&#23558;&#21253;&#21547;&#21709;&#24212;&#20449;&#24687;&#30340;&#21457;&#36865;&#65288;&#36890;&#36807; <tt class="interfacename">SessionAwareMessageListener</tt>&#65289;&#65292;&#20294;&#20854;&#23427;&#36164;&#28304;&#30340;&#25805;&#20316;&#65288;&#20363;&#22914;&#35775;&#38382;&#25968;&#25454;&#24211;&#65289;&#26159;&#29420;&#31435;&#30340;&#12290;&#32463;&#24120;&#20250;&#21457;&#29983;&#31867;&#20284;&#20110;&#25968;&#25454;&#24211;&#22788;&#29702;&#24050;&#25552;&#20132;&#20294;&#28040;&#24687;&#22788;&#29702;&#25552;&#20132;&#22833;&#36133;&#30340;&#24773;&#20917;&#65292;&#22240;&#27492;&#38656;&#35201;&#22312;&#30417;&#21548;&#22120;&#30340;&#23454;&#29616;&#20013;&#36827;&#34892;&#37325;&#22797;&#28040;&#24687;&#30340;&#26816;&#27979;&#12290;
		</p><pre class="programlisting">&lt;bean id="jmsContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer"&gt;
    &lt;property name="connectionFactory" ref="connectionFactory"/&gt;
    &lt;property name="destination" ref="destination"/&gt;
    &lt;property name="messageListener" ref="messageListener"/&gt;
    <span class="bold"><b>&lt;property name="sessionTransacted" value="true"/&gt;</b></span>
&lt;/bean&gt;</pre><p>&#24403;&#21442;&#19982;&#22806;&#37096;&#31649;&#29702;&#30340;&#20107;&#21153;&#26102;&#65292;&#20320;&#38656;&#35201;&#20351;&#29992;&#25903;&#25345;&#22806;&#26469;&#20107;&#21153;&#30340;&#30417;&#21548;&#22120;&#23481;&#22120;&#65306;&#36890;&#24120;&#26159; <tt class="classname">DefaultMessageListenerContainer</tt> &#26469;&#37197;&#32622;&#20107;&#21153;&#31649;&#29702;&#22120;&#12290;
			</p><p>&#21442;&#19982;XA&#20107;&#21153;&#26102;&#65292;&#28040;&#24687;&#30417;&#21548;&#22120;&#23481;&#22120;&#38656;&#35201;&#37197;&#32622; <tt class="classname">JtaTransactionManager</tt>&#65288;&#40664;&#35748;&#20250;&#22996;&#25176;&#32473;J2EE&#26381;&#21153;&#22120;&#20107;&#21153;&#23376;&#31995;&#32479;&#65289;&#12290;&#27880;&#24847;&#20197;&#19979;JMS ConnectionFactory&#38656;&#35201;&#20855;&#26377;XA&#33021;&#21147;&#24182;&#27880;&#20876;JTA&#20107;&#21153;&#21327;&#35843;&#22120;&#65281;&#65288;&#21442;&#32771;&#20320;&#25152;&#20351;&#29992;&#30340;J2EE&#26381;&#21153;&#22120;&#20013;JNDI&#36164;&#28304;&#30340;&#37197;&#32622;&#12290;&#65289;&#36825;&#26679;&#65292;&#28040;&#24687;&#25509;&#25910;&#23601;&#20687;&#25968;&#25454;&#24211;&#35775;&#38382;&#19968;&#26679;&#20316;&#20026;&#21516;&#19968;&#20010;&#20107;&#21153;&#30340;&#19968;&#37096;&#20998;&#65288;&#20855;&#26377;&#32479;&#19968;&#25552;&#20132;&#30340;&#35821;&#20041;&#65292;&#20165;&#20165;&#22686;&#21152;&#20102;XA&#20107;&#21153;&#26085;&#24535;&#30340;&#39069;&#22806;&#24320;&#38144;&#65289;&#12290;
			</p><pre class="programlisting">&lt;bean id="transactionManager" class="org.springframework.transaction.jta.JtaTransactionManager"/&gt;
</pre><p>&#28982;&#21518;&#20320;&#21482;&#38656;&#35201;&#25226;&#23427;&#28155;&#21152;&#21040;&#26089;&#20808;&#37197;&#32622;&#22909;&#30340;&#23481;&#22120;&#20013;&#12290;&#36825;&#20010;&#23481;&#22120;&#23558;&#22788;&#29702;&#21097;&#19979;&#30340;&#20107;&#24773;&#12290;</p><pre class="programlisting">&lt;bean id="jmsContainer" class="org.springframework.jms.listener.DefaultMessageListenerContainer"&gt;
    &lt;property name="connectionFactory" ref="connectionFactory"/&gt;
    &lt;property name="destination" ref="destination"/&gt;
    &lt;property name="messageListener" ref="messageListener"/&gt;
    <span class="bold"><b>&lt;property name="transactionManager" ref="transactionManager"/&gt;</b></span>
&lt;/bean&gt;</pre></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-jca-message-endpoint-manager"></a>19.5.&nbsp;JCA&#28040;&#24687;&#31471;&#28857;&#30340;&#25903;&#25345;</h2></div></div><div></div></div><p>&#20174;Spring2.5&#29256;&#26412;&#24320;&#22987;&#65292;Spring&#20063;&#25552;&#20379;&#20102;&#22522;&#20110;JCA <tt class="interfacename">MessageListener</tt> &#23481;&#22120;&#30340;&#25903;&#25345;&#12290;
     <tt class="classname">JmsMessageEndpointManager</tt> &#23558;&#26681;&#25454;&#20379;&#24212;&#32773; <tt class="interfacename">ResourceAdapter</tt> &#30340;&#31867;&#21517;&#33258;&#21160;&#22320;&#20915;&#23450; <tt class="interfacename">ActivationSpec</tt> &#31867;&#21517;&#12290;&#22240;&#27492;&#65292;&#36890;&#24120;&#23427;&#21482;&#25552;&#20379;&#22914;&#19979;&#20363;&#25152;&#31034;&#30340;Spring&#30340;&#36890;&#29992; <tt class="classname">JmsActivationSpecConfig</tt> &#12290;
    </p><pre class="programlisting">&lt;bean class="org.springframework.jms.listener.endpoint.JmsMessageEndpointManager"&gt;
    &lt;property name="resourceAdapter" ref="resourceAdapter"/&gt;
    &lt;property name="jmsActivationSpecConfig"&gt;
        &lt;bean class="org.springframework.jms.listener.endpoint.JmsActivationSpecConfig"&gt;
            &lt;property name="destinationName" value="myQueue"/&gt;
        &lt;/bean&gt;
    &lt;/property&gt;
    &lt;property name="messageListener" ref="myMessageListener"/&gt;
&lt;/bean&gt;</pre><p>&#20351;&#29992;Spring&#30340; <tt class="classname">ResourceAdapterFactoryBean</tt>&#65292;
    &#30446;&#26631; <tt class="interfacename">ResourceAdapter</tt> &#21487;&#20197;&#20687;&#19979;&#20363;&#25551;&#36848;&#30340;&#37027;&#26679;&#26412;&#22320;&#37197;&#32622;&#12290;
    &#22312;&#19968;&#20123;&#29615;&#22659;&#37324;&#65288;&#22914;WebLogic&#65289;&#20063;&#21487;&#20197;&#36890;&#36807;JNDI&#26597;&#25214;&#26469;&#23436;&#25104;&#12290;
    </p><pre class="programlisting">&lt;bean id="resourceAdapter" class="org.springframework.jca.support.ResourceAdapterFactoryBean"&gt;
    &lt;property name="resourceAdapter"&gt;
        &lt;bean class="org.apache.activemq.ra.ActiveMQResourceAdapter"&gt;
            &lt;property name="serverUrl" value="tcp://localhost:61616"/&gt;
        &lt;/bean&gt;
    &lt;/property&gt;
    &lt;property name="workManager"&gt;
        &lt;bean class="org.springframework.jca.work.SimpleTaskWorkManager"/&gt;
    &lt;/property&gt;
&lt;/bean&gt;</pre><p>&#35831;&#21442;&#32771; <tt class="classname">JmsMessageEndpointManager</tt>&#12289;<tt class="classname">JmsActivationSpecConfig</tt> &#21644; <tt class="classname">ResourceAdapterFactoryBean</tt> &#37096;&#20998;&#30340;JavaDoc&#65292;&#20197;&#33719;&#24471;&#26356;&#35814;&#32454;&#30340;&#20449;&#24687;&#12290;
    </p><p>Spring&#20063;&#25552;&#20379;&#20102;&#24182;&#19981;&#19982;JMS&#32465;&#23450;&#30340;&#36890;&#29992;JCA&#28040;&#24687;&#31471;&#28857;&#31649;&#29702;&#22120;&#65306;
    <tt class="classname">org.springframework.jca.endpoint.GenericMessageEndpointManager</tt>&#12290;
    &#23427;&#20801;&#35768;&#20351;&#29992;&#20219;&#20309;&#31867;&#22411;&#30340;&#28040;&#24687;&#30417;&#21548;&#22120;&#65288;&#20363;&#22914;CCI MessageListener&#65289;&#21644;&#20219;&#20309;&#25552;&#20379;&#32773;&#29305;&#23450;&#30340;ActivationSpec&#23545;&#35937;&#12290;&#20174;&#25152;&#28041;&#21450;&#30340;JCA&#25552;&#20379;&#32773;&#30340;&#25991;&#26723;&#21487;&#20197;&#25214;&#21040;&#36825;&#20010;&#36830;&#25509;&#22120;&#30340;&#23454;&#38469;&#33021;&#21147;&#65292;&#20174; <tt class="classname">GenericMessageEndpointManager</tt> &#30340;JavaDoc&#20013;&#21487;&#20197;&#25214;&#21040;Spring&#29305;&#26377;&#30340;&#37197;&#32622;&#32454;&#33410;&#12290;
    </p><div class="note" style="margin-left: 0.5in; margin-right: 0.5in;"><table border="0" summary="Note"><tr><td rowspan="2" align="center" valign="top" width="25"><img alt="[Note]" src="../images/admons/note.png"></td><th align="left">Note</th></tr><tr><td colspan="2" align="left" valign="top"><p>&#22522;&#20110;JCA&#30340;&#28040;&#24687;&#31471;&#28857;&#31649;&#29702;&#22120;&#19982;EJB 2.1&#30340;Message-Driven Beans&#24456;&#30456;&#20284;&#65292;&#23427;&#20351;&#29992;&#20102;&#30456;&#21516;&#30340;&#36164;&#28304;&#25552;&#20379;&#32773;&#32422;&#23450;&#12290;&#20687;EJB 2.1 MDB&#19968;&#26679;&#65292;&#20219;&#20309;&#34987;JCA&#25552;&#20379;&#32773;&#25903;&#25345;&#30340;&#28040;&#24687;&#30417;&#21548;&#22120;&#25509;&#21475;&#37117;&#21487;&#20197;&#22312;Spring Context&#20013;&#20351;&#29992;&#12290;&#23613;&#31649;&#22914;&#27492;&#65292;Spring&#20173;&#20026;JMS&#25552;&#20379;&#20102;&#26174;&#24335;&#30340;&#8220;&#26041;&#20415;&#30340;&#8221;&#25903;&#25345;&#65292;&#24456;&#26174;&#28982;&#26159;&#22240;&#20026;JMS&#26159;JCA&#31471;&#28857;&#31649;&#29702;&#32422;&#23450;&#20013;&#26368;&#36890;&#29992;&#30340;&#31471;&#28857;API&#12290;
       </p></td></tr></table></div></div><div class="section" lang="en"><div class="titlepage"><div><div><h2 class="title" style="clear: both"><a name="jms-namespace"></a>19.6.&nbsp;JMS&#21629;&#21517;&#31354;&#38388;&#25903;&#25345;</h2></div></div><div></div></div><p>Spring 2.5&#24341;&#20837;&#20102;XML&#21629;&#21517;&#31354;&#38388;&#20197;&#31616;&#21270;JMS&#30340;&#37197;&#32622;&#12290;&#20351;&#29992;JMS&#21629;&#21517;&#31354;&#38388;&#20803;&#32032;&#26102;&#65292;&#38656;&#35201;&#24341;&#29992;&#22914;&#19979;&#30340;JMS Schema&#65306;
	</p><pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       <span class="bold"><b>xmlns:jms="http://www.springframework.org/schema/jms"</b></span>
       xsi:schemaLocation="
http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd
<span class="bold"><b>http://www.springframework.org/schema/jms http://www.springframework.org/schema/jms/spring-jms-2.5.xsd"</b></span>&gt;

<i class="lineannotation"><span class="lineannotation">&lt;!-- <tt class="literal">&lt;bean/&gt;</tt> definitions here --&gt;</span></i>

&lt;/beans&gt;</pre><p>&#36825;&#20010;&#21629;&#21517;&#31354;&#38388;&#30001;&#20004;&#32423;&#20803;&#32032;&#32452;&#25104;&#65306;<tt class="literal">&lt;listener-container/&gt;</tt> &#21644; <tt class="literal">&lt;jca-listener-container/&gt;</tt>&#65292;&#23427;&#20204;&#37117;&#21487;&#20197;&#21253;&#21547;&#19968;&#20010;&#25110;&#36825;&#20010;&#22810;&#20010; <tt class="literal">&lt;listener/&gt;</tt> &#23376;&#20803;&#32032;&#12290;&#19979;&#38754;&#26159;&#19968;&#20010;&#22522;&#26412;&#37197;&#32622;&#30340;&#31034;&#20363;&#65292;&#21253;&#21547;&#20004;&#20010;&#30417;&#21548;&#22120;&#12290;</p><pre class="programlisting">&lt;jms:listener-container&gt;

    &lt;jms:listener destination="queue.orders" ref="orderService" method="placeOrder"/&gt;

    &lt;jms:listener destination="queue.confirmations" ref="confirmationLogger" method="log"/&gt;

&lt;/jms:listener-container&gt;</pre><p>&#19978;&#38754;&#30340;&#20363;&#23376;&#31561;&#21516;&#20110;&#22312; <a href="jms.html#jms-receiving-async-message-listener-adapter" title="19.4.4.&nbsp;MessageListenerAdapter">Section&nbsp;19.4.4, &#8220;MessageListenerAdapter&#8221;</a> &#30340;&#31034;&#20363;&#20013;&#65292;&#23450;&#20041;&#20004;&#20010;&#19981;&#21516;&#30340;&#30417;&#21548;&#22120;&#23481;&#22120;&#21644;&#20004;&#20010;&#19981;&#21516;&#30340; <tt class="classname">MessageListenerAdapter</tt> &#12290;&#38500;&#20102;&#19978;&#38754;&#30340;&#23646;&#24615;&#22806;&#65292;<tt class="literal">listener</tt> &#20803;&#32032;&#36824;&#20855;&#26377;&#20960;&#20010;&#21487;&#36873;&#30340;&#23646;&#24615;&#12290;&#19979;&#38754;&#30340;&#34920;&#26684;&#21015;&#20986;&#20102;&#25152;&#26377;&#30340;&#23646;&#24615;&#65306;
   </p><div class="table"><a name="jms-namespace-listener-tbl"></a><p class="title"><b>Table&nbsp;19.1.&nbsp;JMS <tt class="literal">listener</tt> &#20803;&#32032;&#30340;&#23646;&#24615;</b></p><table summary="JMS listener &#20803;&#32032;&#30340;&#23646;&#24615;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;</th><th>&#25551;&#36848;</th></tr></thead><tbody><tr><td>id</td><td><p>&#30417;&#21548;&#22120;&#23481;&#22120;&#30340;Bean&#21517;&#31216;&#12290;&#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#23558;&#33258;&#21160;&#29983;&#25104;&#19968;&#20010;Bean&#21517;&#31216;&#12290;</p></td></tr><tr><td>destination <span class="bold"><b>&#65288;&#24517;&#39035;&#65289;</b></span></td><td><p>&#30417;&#21548;&#22120;&#30446;&#30340;&#22320;&#30340;&#21517;&#31216;&#65292;&#30001; <tt class="interfacename">DestinationResolver</tt> &#30340;&#31574;&#30053;&#20915;&#23450;&#12290;</p></td></tr><tr><td>ref <span class="bold"><b>&#65288;&#24517;&#39035;&#65289;</b></span></td><td><p>&#22788;&#29702;&#23545;&#35937;&#30340;Bean&#21517;&#31216;</p></td></tr><tr><td>method</td><td><p>&#22788;&#29702;&#22120;&#20013;&#34987;&#35843;&#29992;&#30340;&#26041;&#27861;&#21517;&#12290;&#22914;&#26524; <tt class="literal">ref</tt> &#25351;&#21521;
                        <tt class="interfacename">MessageListener</tt> &#25110;&#32773; Spring
                        <tt class="interfacename">SessionAwareMessageListener</tt>&#65292;&#21017;&#36825;&#20010;&#23646;&#24615;&#21487;&#20197;&#34987;&#24573;&#30053;&#12290;
                        </p></td></tr><tr><td>response-destination</td><td><p>&#40664;&#35748;&#30340;&#21709;&#24212;&#30446;&#30340;&#22320;&#26159;&#21457;&#36865;&#21709;&#24212;&#28040;&#24687;&#25269;&#36798;&#30340;&#30446;&#30340;&#22320;&#12290; &#36825;&#29992;&#20110;&#35831;&#27714;&#28040;&#24687;&#27809;&#26377;&#21253;&#21547;"JMSReplyTo"&#22495;&#30340;&#24773;&#20917;&#12290;&#21709;&#24212;&#30446;&#30340;&#22320;&#31867;&#22411;&#34987;&#30417;&#21548;&#22120;&#23481;&#22120;&#30340;"destination-type"&#23646;&#24615;&#20915;&#23450;&#12290;&#35760;&#20303;&#65306;&#36825;&#20165;&#20165;&#36866;&#29992;&#20110;&#26377;&#36820;&#22238;&#20540;&#30340;&#30417;&#21548;&#22120;&#26041;&#27861;&#65292;&#22240;&#20026;&#27599;&#20010;&#32467;&#26524;&#23545;&#35937;&#37117;&#20250;&#34987;&#36716;&#21270;&#25104;&#21709;&#24212;&#28040;&#24687;&#12290;
                        </p></td></tr><tr><td>subscription</td><td><p>&#25345;&#20037;&#35746;&#38405;&#30340;&#21517;&#31216;&#65292;&#22914;&#26524;&#38656;&#35201;&#30340;&#35805;&#12290;</p></td></tr><tr><td>selector</td><td><p>&#30417;&#21548;&#22120;&#30340;&#19968;&#20010;&#21487;&#36873;&#30340;&#28040;&#24687;&#36873;&#25321;&#22120;&#12290;</p></td></tr></tbody></table></div><p><tt class="literal">&lt;listener-container/&gt;</tt>&#20803;&#32032;&#20063;&#26377;&#20960;&#20010;&#21487;&#36873;&#30340;&#23646;&#24615;&#12290;
    &#36825;&#20123;&#23646;&#24615;&#20801;&#35768;&#20687; &#22522;&#26412;&#30340; JMS&#35774;&#32622;&#21644;&#36164;&#28304;&#24341;&#29992;&#19968;&#26679;&#26469;&#23450;&#20041;&#19981;&#21516;&#30340;&#31574;&#30053; &#65288;&#20363;&#22914;
    <span class="property">taskExecutor</span> &#21644; <span class="property">destinationResolver</span>&#65289;&#12290;
    &#20351;&#29992;&#36825;&#20123;&#23646;&#24615;&#65292;&#21487;&#20197;&#23450;&#20041;&#24456;&#24191;&#27867;&#30340;&#23450;&#21046;&#30417;&#21548;&#22120;&#23481;&#22120;&#65292;&#21516;&#26102;&#20173;&#20139;&#26377;&#21629;&#21517;&#31354;&#38388;&#30340;&#20415;&#21033;&#12290;</p><pre class="programlisting">&lt;jms:listener-container connection-factory="myConnectionFactory"
                        task-executor="myTaskExecutor"
                        destination-resolver="myDestinationResolver"
                        transaction-manager="myTransactionManager"
                        concurrency="10"&gt;

    &lt;jms:listener destination="queue.orders" ref="orderService" method="placeOrder"/&gt;

    &lt;jms:listener destination="queue.confirmations" ref="confirmationLogger" method="log"/&gt;

&lt;/jms:listener-container&gt;</pre><p>&#19979;&#38754;&#30340;&#34920;&#26684;&#25551;&#36848;&#20102;&#25152;&#26377;&#21487;&#29992;&#30340;&#23646;&#24615;&#12290;&#21442;&#32771; <tt class="classname">AbstractMessageListenerContainer</tt> &#31867;&#21644;&#20855;&#20307;&#23376;&#31867;&#30340;Javadoc&#26469;&#20102;&#35299;&#27599;&#20010;&#23646;&#24615;&#30340;&#32454;&#33410;&#12290;&#36825;&#37096;&#20998;&#30340;Javadoc&#20063;&#25552;&#39640;&#37027;&#20010;&#20102;&#20107;&#21153;&#36873;&#25321;&#21644;&#28040;&#24687;&#20256;&#36755;&#22330;&#26223;&#30340;&#35752;&#35770;&#12290;</p><div class="table"><a name="jms-namespace-listener-container-tbl"></a><p class="title"><b>Table&nbsp;19.2.&nbsp;JMS <tt class="literal">&lt;listener-container/&gt;</tt> &#20803;&#32032;&#30340;&#23646;&#24615;</b></p><table summary="JMS <listener-container/&gt; &#20803;&#32032;&#30340;&#23646;&#24615;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;</th><th>&#25551;&#36848;</th></tr></thead><tbody><tr><td>container-type</td><td><p>&#30417;&#21548;&#22120;&#23481;&#22120;&#30340;&#31867;&#22411;&#12290;&#21487;&#29992;&#30340;&#36873;&#39033;&#26159;&#65306; 
                        <tt class="literal">default</tt>&#12289;<tt class="literal">simple</tt>&#12289;<tt class="literal">default102</tt> &#25110;&#32773; <tt class="literal">simple102</tt>
                        &#65288;&#40664;&#35748;&#20540;&#26159; <tt class="literal">'default'</tt>&#65289;&#12290;</p></td></tr><tr><td>connection-factory</td><td><p>JMS <tt class="interfacename">ConnectionFactory</tt> Bean&#30340;&#24341;&#29992;&#65288;&#40664;&#35748;&#30340;Bean&#21517;&#31216;&#26159; <tt class="literal">'connectionFactory'</tt>&#65289;&#12290;</p></td></tr><tr><td>task-executor</td><td><p>JMS&#30417;&#21548;&#22120;&#35843;&#29992;&#32773;Spring <tt class="interfacename">TaskExecutor</tt>
                      &#30340;&#24341;&#29992;&#12290;</p></td></tr><tr><td>destination-resolver</td><td><p><tt class="interfacename">DestinationResolver</tt> &#31574;&#30053;&#30340;&#24341;&#29992;&#65292;&#29992;&#20197;&#35299;&#26512;JMS <tt class="interfacename">Destinations</tt>&#12290;
                        </p></td></tr><tr><td>message-converter</td><td><p><tt class="interfacename">MessageConverter</tt>
                        &#31574;&#30053;&#30340;&#24341;&#29992;&#65292;&#29992;&#20197;&#36716;&#25442;JMS Messages &#25104;&#30417;&#21548;&#22120;&#26041;&#27861;&#30340;&#21442;&#25968;&#12290;&#40664;&#35748;&#20540;&#26159; <tt class="classname">SimpleMessageConverter</tt>&#12290;</p></td></tr><tr><td>destination-type</td><td><p>&#30417;&#21548;&#22120;&#30340;JMS&#30446;&#30340;&#22320;&#31867;&#22411;&#12290;&#21487;&#29992;&#30340;&#36873;&#39033;&#21253;&#21547;&#65306;
                        <tt class="literal">queue</tt>&#12289;<tt class="literal">topic</tt> &#25110;&#32773; <tt class="literal">durableTopic</tt> &#65288;&#40664;&#35748;&#20540;&#26159; <tt class="literal">'queue'</tt>&#65289;&#12290;</p></td></tr><tr><td>client-id</td><td><p>&#36825;&#20010;&#30417;&#21548;&#22120;&#23481;&#22120;&#22312;JMS&#23458;&#25143;&#31471;&#30340;id&#12290;</p></td></tr><tr><td>acknowledge</td><td><p>&#26412;&#22320;JMS&#24212;&#31572;&#27169;&#24335;&#12290;&#21487;&#29992;&#30340;&#36873;&#39033;&#21253;&#21547;&#65306;
                        <tt class="literal">auto</tt>&#12289;<tt class="literal">client</tt>&#12289;<tt class="literal">dups-ok</tt> &#25110;&#32773; <tt class="literal">transacted</tt>
                        &#65288;&#40664;&#35748;&#20540;&#26159; <tt class="literal">'auto'</tt>&#65289;&#12290;
                        <tt class="literal">'transacted'</tt> &#30340;&#20540;&#21487;&#28608;&#27963;&#26412;&#22320;&#20107;&#21153;&#24615; <tt class="interfacename">Session</tt>&#12290;
                        &#20063;&#21487;&#20197;&#36890;&#36807;&#25351;&#23450;&#19979;&#38754;&#20171;&#32461;&#30340; <tt class="literal">transaction-manager</tt> &#23646;&#24615;&#12290;</p></td></tr><tr><td>transaction-manager</td><td><p>Spring <tt class="interfacename">PlatformTransactionManager</tt> &#30340;&#24341;&#29992;&#12290;</p></td></tr><tr><td>concurrency</td><td><p>&#27599;&#20010;&#30417;&#21548;&#22120;&#21487;&#28608;&#27963;&#30340;Session&#26368;&#22823;&#24182;&#21457;&#25968;&#12290;</p></td></tr><tr><td>prefetch</td><td><p>&#21152;&#36733;&#36827;&#27599;&#20010;Session&#30340;&#26368;&#22823;&#28040;&#24687;&#25968;&#12290;&#35760;&#20303;&#22686;&#21152;&#36825;&#20010;&#20540;&#20250;&#36896;&#25104;&#24182;&#21457;&#31354;&#38386;&#12290;</p></td></tr></tbody></table></div><p>&#20351;&#29992;&#8220;jms&#8221; Schema&#25903;&#25345;&#26469;&#37197;&#32622;&#22522;&#20110;JCA&#30340;&#30417;&#21548;&#22120;&#23481;&#22120;&#24456;&#30456;&#20284;&#12290;</p><pre class="programlisting">&lt;jms:jca-listener-container resource-adapter="myResourceAdapter"
                            destination-resolver="myDestinationResolver"
                            transaction-manager="myTransactionManager"
                            concurrency="10"&gt;

    &lt;jms:listener destination="queue.orders" ref="myMessageListener"/&gt;

&lt;/jms:jca-listener-container&gt;</pre><p>JCA&#21487;&#29992;&#30340;&#37197;&#32622;&#36873;&#39033;&#25551;&#36848;&#22914;&#19979;&#34920;&#65306;</p><div class="table"><a name="jms-namespace-jca-listener-container-tbl"></a><p class="title"><b>Table&nbsp;19.3.&nbsp;JMS <tt class="literal">&lt;jca-listener-container/&gt;</tt> &#20803;&#32032;&#30340;&#23646;&#24615;</b></p><table summary="JMS <jca-listener-container/&gt; &#20803;&#32032;&#30340;&#23646;&#24615;" border="1"><colgroup><col><col></colgroup><thead><tr><th>&#23646;&#24615;</th><th>&#25551;&#36848;</th></tr></thead><tbody><tr><td>resource-adapter</td><td><p>JCA <tt class="interfacename">ResourceAdapter</tt> Bean &#30340;&#19968;&#20010;&#24341;&#29992;&#65288;&#40664;&#35748;&#30340;Bean&#21517;&#31216;&#26159;<tt class="literal">'resourceAdapter'</tt>&#65289;&#12290;</p></td></tr><tr><td>activation-spec-factory</td><td><p><tt class="interfacename">JmsActivationSpecFactory</tt> &#30340;&#19968;&#20010;&#24341;&#29992;&#12290;
                        &#40664;&#35748;&#33258;&#21160;&#26816;&#27979;JMS&#25552;&#20379;&#32773;&#21644;&#23427;&#30340; <tt class="interfacename">ActivationSpec</tt> &#31867;
                        &#65288;&#21442;&#32771; <tt class="classname">DefaultJmsActivationSpecFactory</tt>&#65289;</p></td></tr><tr><td>destination-resolver</td><td><p><tt class="interfacename">DestinationResolver</tt> &#31574;&#30053;&#30340;&#24341;&#29992;&#65292;&#29992;&#20197;&#35299;&#26512;JMS <tt class="interfacename">Destinations</tt>&#12290;
                        </p></td></tr><tr><td>message-converter</td><td><p><tt class="interfacename">MessageConverter</tt> &#31574;&#30053;&#30340;&#24341;&#29992;&#65292;&#29992;&#20197;&#36716;&#25442;JMS Messages &#25104;&#30417;&#21548;&#22120;&#26041;&#27861;&#21442;&#25968;&#12290;
                        &#40664;&#35748;&#20540;&#26159; <tt class="classname">SimpleMessageConverter</tt>&#12290;
                        </p></td></tr><tr><td>destination-type</td><td><p>&#30417;&#21548;&#22120;&#30340;JMS&#30446;&#30340;&#22320;&#31867;&#22411;&#12290;&#21487;&#29992;&#30340;&#36873;&#39033;&#21253;&#21547; <tt class="literal">queue</tt>&#12289;<tt class="literal">topic</tt> &#25110;&#32773; <tt class="literal">durableTopic</tt>
                        &#40664;&#35748;&#26159; <tt class="literal">'queue'</tt>&#65289;&#12290;</p></td></tr><tr><td>client-id</td><td><p>&#36825;&#20010;&#30417;&#21548;&#22120;&#23481;&#22120;&#22312;JMS&#23458;&#25143;&#31471;&#30340;id&#12290;</p></td></tr><tr><td>acknowledge</td><td><p>&#26412;&#22320;JMS&#24212;&#31572;&#27169;&#24335;&#12290;&#21487;&#29992;&#30340;&#36873;&#39033;&#21253;&#21547;&#65306;<tt class="literal">auto</tt>&#12289;<tt class="literal">client</tt>&#12289;<tt class="literal">dups-ok</tt> &#25110;&#32773; <tt class="literal">transacted</tt>
                        &#65288;&#40664;&#35748;&#20540;&#26159; <tt class="literal">'auto'</tt>&#65289;&#12290;
                          <tt class="literal">'transacted'</tt> &#30340;&#20540;&#21487;&#28608;&#27963;&#26412;&#22320;&#20107;&#21153;&#24615; <tt class="interfacename">Session</tt>&#12290;
                          &#20063;&#21487;&#20197;&#36890;&#36807;&#25351;&#23450;&#19979;&#38754;&#20171;&#32461;&#30340; <tt class="literal">transaction-manager</tt> &#23646;&#24615;</p></td></tr><tr><td>transaction-manager</td><td><p>Spring <tt class="classname">JtaTransactionManager</tt>
                        &#25110;&#32773; <tt class="interfacename">javax.transaction.TransactionManager</tt> &#30340;&#24341;&#29992;&#65292;&#29992;&#20197;&#20026;&#20256;&#36827;&#30340;&#28040;&#24687;&#24212;&#29992;XA&#20107;&#21153;&#12290;
                        &#22914;&#26524;&#27809;&#26377;&#25351;&#23450;&#65292;&#23558;&#20351;&#29992;&#26412;&#22320;&#24212;&#31572;&#27169;&#22411;&#65288;&#21442;&#35265;&#8220;acknowledge&#8221;&#23646;&#24615;&#65289;&#12290;
                        </p></td></tr><tr><td>concurrency</td><td><p>&#27599;&#20010;&#30417;&#21548;&#22120;&#21487;&#28608;&#27963;&#30340;Session&#26368;&#22823;&#24182;&#21457;&#25968;&#12290;</p></td></tr><tr><td>prefetch</td><td><p>&#21152;&#36733;&#36827;&#27599;&#20010;Session&#30340;&#26368;&#22823;&#28040;&#24687;&#25968;&#12290;&#35760;&#20303;&#22686;&#21152;&#36825;&#20010;&#20540;&#20250;&#36896;&#25104;&#24182;&#21457;&#31354;&#38386;&#12290;</p></td></tr></tbody></table></div></div></div><div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter"><hr><table width="100%" summary="Navigation footer"><tr><td width="40%" align="left"><a accesskey="p" href="ejb.html">Prev</a>&nbsp;</td><td width="20%" align="center"><a accesskey="h" href="index.html">Home</a></td><td width="40%" align="right">&nbsp;<a accesskey="n" href="jmx.html">Next</a></td></tr><tr><td width="40%" align="left" valign="top">Chapter&nbsp;18.&nbsp;Enterprise Java Beans (EJB) &#38598;&#25104;&nbsp;</td><td width="20%" align="center"><span style="color:white;font-size:90%;"><a href="http://www.springsource.com/" title="SpringSource">Sponsored by SpringSource</a></span></td><td width="40%" align="right" valign="top">&nbsp;Chapter&nbsp;20.&nbsp;JMX</td></tr></table></div></body></html>